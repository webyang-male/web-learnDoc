### é¢å‘è¿‡ç¨‹ ä¸  é¢å‘å¯¹è±¡       

> JavaScriptæ˜¯ä¸€ç§åŸºäºå¯¹è±¡çš„è¯­è¨€

é¢å‘è¿‡ç¨‹æ˜¯ä¸€ä»¶äº‹â€œè¯¥æ€ä¹ˆåšâ€œï¼Œé¢å‘å¯¹è±¡æ˜¯ä¸€ä»¶äº‹â€œè¯¥è®©è°æ¥åšâ€ï¼Œç„¶åé‚£ä¸ªâ€œè°â€å°±æ˜¯å¯¹è±¡ï¼Œä»–è¦æ€ä¹ˆåšæ˜¯ä»–è‡ªå·±çš„äº‹ï¼Œåæ­£æœ€åä¸€ç¾¤å¯¹è±¡åˆåŠ›èƒ½æŠŠäº‹åšå¥½å°±è¡Œäº†ã€‚ 				------ çŸ¥ä¹

#### ç±»å’Œå¯¹è±¡

ç±»(class)æ˜¯å¯¹è±¡(object)çš„æ¨¡æ¿ï¼Œå®šä¹‰äº†åŒä¸€ç»„å¯¹è±¡å…±æœ‰çš„å±æ€§å’Œæ–¹æ³•

### ç±»ä¸ç»§æ‰¿

#### ES5ä¸­çš„ç±»ä¸ç»§æ‰¿

##### ç±»

> é™æ€æ–¹æ³•é‡Œçš„thisæŒ‡å‘æ„é€ å‡½æ•°
>
> æ„é€ å‡½æ•°thisæŒ‡å‘å®ä¾‹åŒ–å¯¹è±¡

````js
// ç±»
function People(name, age) {
    // console.log(this)
    this.name = name
    this.age = age
}
// å®ä¾‹æ–¹æ³•
People.prototype.showName = function () {
    console.log('æˆ‘çš„åå­—æ˜¯' + this.name)
}
// {name: 'LX', age: 18}
// æˆ‘çš„åå­—æ˜¯LX
// {name: 'zhangsan', age: 18}
// æˆ‘çš„åå­—æ˜¯zhangsan
let p1 = new People('LX', 18)
console.log(p1)
p1.showName()

let p2 = new People('zhangsan', 18)
console.log(p2)
p2.showName()
````

> ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ–¹æ³•ä¸ä¼šå†™åœ¨æ„é€ å‡½æ•°ä¸‹(æ¯æ¬¡å®ä¾‹åŒ–éƒ½ä¼šæœ‰ä¸€ä¸ªæ–¹æ³•) ä¸€èˆ¬æ”¾åœ¨åŸå‹ä¸Š 

```js
// ç±»
function People(name, age) {
    // console.log(this)
    // å®ä¾‹å±æ€§
    this.name = name
    this.age = age
    People.count++
}
// é™æ€å±æ€§
People.count = 0
// é™æ€æ–¹æ³•
People.getCount = function(){
  /* Æ’ People(name, age) {
    console.log(this); // å®ä¾‹å±æ€§
    this.name = name;
    this.age = age;
    People.count++;
  } */
    console.log(this)//æŒ‡å‘æ„é€ å‡½æ•°
    console.log(this.age) // undefined
    console.log('å½“å‰å…±æœ‰' + People.count + 'ä¸ªäºº')
}

// å®ä¾‹æ–¹æ³•
People.prototype.showName = function () {
    console.log('æˆ‘çš„åå­—æ˜¯' + this.name)
}

//p1,p2å®ä¾‹åŒ–å¯¹è±¡
let p1 = new People('lx', 18)
console.log(p1)
p1.showName()

let p2 = new People('zhangsan', 20)
console.log(p2)
p2.showName()

console.log(People.count)
People.getCount()//é™æ€æ–¹æ³•è°ƒç”¨

// let str = new String('imooc')
// console.log(str)

// let arr = new Array(1, 2, 3)
// console.log(arr)

// let obj = new Object()
// obj.name = 'zain'
// console.log(obj)

// é™æ€æ–¹æ³•
// console.log(Math.max(4, 5))
// console.log(Math.random())
```

##### ç»§æ‰¿

> æ„é€ å‡½æ•°ç»§æ‰¿åªèƒ½ç»§æ‰¿çˆ¶ç±»çš„å±æ€§ï¼ŒåŸå‹çš„ç»§æ‰¿å¯ä»¥ç»§æ‰¿æ–¹æ³•

`````js
// çˆ¶ç±»
function Animal(name) {
    this.name = name
}
Animal.prototype.showName = function () {
    console.log('åå­—æ˜¯:' + this.name)
}

// å­ç±»
function Dog(name, color) {
    Animal.call(this, name) // æ„é€ å‡½æ•°ç»§æ‰¿å±æ€§
    this.color = color
}
//åŸå‹ç»§æ‰¿æ–¹æ³•
Dog.prototype = new Animal()
//prototypeçš„constructorå±æ€§åº”è¯¥æ˜¯æŒ‡å‘å®ƒçš„æ„é€ å‡½æ•°çš„ã€‚
//ä¸Šé¢è¿™ä¸€å¥è®©Dog.prototype.constructoræŒ‡å‘äº†Animalï¼Œæ‰€ä»¥éœ€è¦æ”¹å›Dog
Dog.prototype.constuctor = Dog

let d1 = new Dog('wangcai', 'white')
console.log(d1)
d1.showName()
//DogÂ {name: 'wangcai', color: 'white'}
//åå­—æ˜¯:wangcai
`````

#### ES6ä¸­çš„ç±»ä¸ç»§æ‰¿

````js
class People {
    constructor(name, age) {//æ„é€ å‡½æ•°constructor
        this.name = name
        this.age = age
        this._sex = -1
    }
    // static count = 0
    get sex() { // å±æ€§
        if (this._sex === 1) {
            return 'male'
        } else if (this._sex === 0) {
            return 'female'
        } else {
            return 'error'
        }
    }
    set sex(val) { // 1:male 0:female
        if (val === 0 || val === 1) {
            this._sex = val
        }
    }
    showName() {
        console.log(this.name)
    }
    // é™æ€æ–¹æ³•
    static getCount() {
        return 5
    }
}
// é™æ€å±æ€§
People.count = 9
console.log(typeof People) // function
console.log(People.count)

let p1 = new People('zain', 18)
console.log(p1)
p1.sex = 5
console.log(p1.sex)
console.log(People.getCount())

//extendså®ç°ç±»ä¹‹é—´çš„ç»§æ‰¿
class Coder extends People {
    constructor(name, age, company) {
        super(name, age)//superå…³é”®å­—ç»§æ‰¿çˆ¶ç±»å±æ€§å’Œæ–¹æ³•
        this.company = company
    }
    showCompany() {
        console.log(this.company)
    }
}

let c1 = new Coder('zhangsan', 25, 'imooc')
console.log(c1)
c1.showName()
c1.showCompany()
c1.sex = 1
console.log(c1.sex)
console.log(Coder.getCount())
````

##### âœ’ã€æ‹“å±•ç†è§£ã€‘

â€‹		<font style="color:deepskyblue;">classå®ç°ç»§æ‰¿çš„æ³¨æ„äº‹é¡¹</font>

1ã€class å£°æ˜ä¸ä¼šæå‡ã€‚Foo è¿›å…¥æš‚æ—¶æ€§æ­»åŒºï¼Œç±»ä¼¼äº letã€const å£°æ˜å˜é‡

````js
const bar = new Bar(); // it's ok
function Bar() {
  this.bar = 42;
}

const foo = new Foo(); // ReferenceError: Foo is not defined
class Foo {
  constructor() {
    this.foo = 42;
  }
}
````

2ã€class å£°æ˜å†…éƒ¨ä¼šå¯ç”¨ä¸¥æ ¼æ¨¡å¼

````js
// å¼•ç”¨ä¸€ä¸ªæœªå£°æ˜çš„å˜é‡
function Bar() {
  baz = 42; // it's ok
}
const bar = new Bar();

class Foo {
  constructor() {
    fol = 42; // ReferenceError: fol is not defined
  }
}
const foo = new Foo();
````

3ã€class çš„æ‰€æœ‰æ–¹æ³•ï¼ˆåŒ…æ‹¬é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ï¼‰éƒ½æ˜¯ä¸å¯æšä¸¾çš„

````js
// å¼•ç”¨ä¸€ä¸ªæœªå£°æ˜çš„å˜é‡
function Bar() {
  this.bar = 42;
}
Bar.answer = function() {
  return 42;
};
Bar.prototype.print = function() {
  console.log(this.bar);
};
const barKeys = Object.keys(Bar); // ['answer']
const barProtoKeys = Object.keys(Bar.prototype); // ['print']

class Foo {
  constructor() {
    this.foo = 42;
  }
  static answer() {
    return 42;
  }
  print() {
    console.log(this.foo);
  }
}
const fooKeys = Object.keys(Foo); // []
const fooProtoKeys = Object.keys(Foo.prototype); // []
````

4ã€class çš„æ‰€æœ‰æ–¹æ³•ï¼ˆåŒ…æ‹¬é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ï¼‰éƒ½æ²¡æœ‰åŸå‹å¯¹è±¡ prototypeï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰[[construct]]ï¼Œä¸èƒ½ä½¿ç”¨ new æ¥è°ƒç”¨

````js
function Bar() {
  this.bar = 42;
}
Bar.prototype.print = function() {
  console.log(this.bar);
};

const bar = new Bar();
const barPrint = new bar.print(); // it's ok

class Foo {
  constructor() {
    this.foo = 42;
  }
  print() {
    console.log(this.foo);
  }
}
const foo = new Foo();
const fooPrint = new foo.print(); // TypeError: foo.print is not a constructor
````

5ã€å¿…é¡»ä½¿ç”¨ new è°ƒç”¨ class

```js
function Bar() {
  this.bar = 42;
}
const bar = Bar(); // it's ok

class Foo {
  constructor() {
    this.foo = 42;
  }
}
const foo = Foo(); // TypeError: Class constructor Foo cannot be invoked without 'new'
```

6ã€class å†…éƒ¨æ— æ³•é‡å†™ç±»å

```js
function Bar() {
  Bar = 'Baz'; // it's ok
  this.bar = 42;
}
const bar = new Bar();
// Bar: 'Baz'
// bar: Bar {bar: 42}  

class Foo {
  constructor() {
    this.foo = 42;
    Foo = 'Fol'; // TypeError: Assignment to constant variable
  }
}
const foo = new Foo();
Foo = 'Fol'; // it's ok
```

### åŸå§‹æ•°æ®ç±»å‹Symbol

> ES6 å¼•å…¥äº†ä¸€ç§æ–°çš„åŸå§‹æ•°æ®ç±»å‹ `Symbol` ï¼Œè¡¨ç¤ºç‹¬ä¸€æ— äºŒçš„å€¼ã€‚

#### å£°æ˜æ–¹å¼

1.ç®€å•å£°æ˜(éš¾ä»¥ç†è§£å…¶ä»£è¡¨æ„ä¹‰)

````js
let s1 = Symbol()
let s2 = Symbol()
console.log(s1)
console.log(s2)
console.log(s1 === s2) // false
````

<div class="custom-block warning"><p class="custom-block-title">æ³¨æ„</p> <p>Symbolå‡½æ•°å‰ä¸èƒ½ä½¿ç”¨newå‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºç”Ÿæˆçš„ Symbol æ˜¯ä¸€ä¸ªåŸå§‹ç±»å‹çš„å€¼ï¼Œä¸æ˜¯å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”±äº Symbol å€¼ä¸æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ä¸èƒ½æ·»åŠ å±æ€§ã€‚åŸºæœ¬ä¸Šï¼Œå®ƒæ˜¯ä¸€ç§ç±»ä¼¼äºå­—ç¬¦ä¸²çš„æ•°æ®ç±»å‹ã€‚</p></div>

2.å­—ç¬¦ä¸²å£°æ˜

> Symbolå‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œè¡¨ç¤ºå¯¹ Symbol å®ä¾‹çš„æè¿°ï¼Œä¸»è¦æ˜¯ä¸ºäº†åœ¨æ§åˆ¶å°æ˜¾ç¤ºï¼Œæˆ–è€…è½¬ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œæ¯”è¾ƒå®¹æ˜“åŒºåˆ†ã€‚

````js
let s1 = Symbol('foo')
let s2 = Symbol('bar')
console.log(s1)
console.log(s2)
console.log(s1 === s2)// false
````

3.å¯¹è±¡æ–¹æ³•

`````js
const obj = {
    name: 'imooc',
    toString() {
        return this.name
    }
}
let s = Symbol(obj)
console.log(s)//Symbol(imooc)
`````

#### 1ä¸ªAPI

````js
let s = Symbol('foo')
console.log(s.description)//foo
````

#### Symbol.for()

`Symbol.for()` æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œç„¶åæœç´¢æœ‰æ²¡æœ‰ä»¥è¯¥å‚æ•°ä½œä¸ºåç§°çš„ Symbol å€¼ã€‚å¦‚æœæœ‰ï¼Œå°±è¿”å›è¿™ä¸ª Symbol å€¼ï¼Œå¦åˆ™å°±æ–°å»ºä¸€ä¸ªä»¥è¯¥å­—ç¬¦ä¸²ä¸ºåç§°çš„ Symbol å€¼ï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ°`å…¨å±€`ã€‚

```js
let s1 = Symbol.for('foo')
let s2 = Symbol.for('foo')
console.log(s1 === s2) // true
```

````js
function foo() {
    return Symbol.for('foo')
}
const x = foo()
const y = Symbol.for('foo')
console.log(x === y) // true
````

<div class="custom-block warning"><p class="custom-block-title">æ³¨æ„</p> <p>Symbol.for()ä¸Symbol()è¿™ä¸¤ç§å†™æ³•ï¼Œéƒ½ä¼šç”Ÿæˆæ–°çš„ Symbolã€‚å®ƒä»¬çš„åŒºåˆ«æ˜¯ï¼Œå‰è€…ä¼šè¢«ç™»è®°åœ¨å…¨å±€ç¯å¢ƒä¸­ä¾›æœç´¢ï¼Œåè€…ä¸ä¼šã€‚Symbol.for()ä¸ä¼šæ¯æ¬¡è°ƒç”¨å°±è¿”å›ä¸€ä¸ªæ–°çš„ Symbol ç±»å‹çš„å€¼ï¼Œè€Œæ˜¯ä¼šå…ˆæ£€æŸ¥ç»™å®šçš„keyæ˜¯å¦å·²ç»å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨æ‰ä¼šæ–°å»ºä¸€ä¸ªå€¼ã€‚</p></div>

#### Symbol.keyFor()

> Symbol.keyFor()æ–¹æ³•è¿”å›ä¸€ä¸ªå·²ç™»è®°çš„ Symbol ç±»å‹å€¼çš„keyã€‚

```js
const s1 = Symbol('foo')
console.log(Symbol.keyFor(s1)) // undefined

const s2 = Symbol.for('foo')
console.log(Symbol.keyFor(s2)) // foo
```

#### ä½¿ç”¨åœºæ™¯

##### ä½œä¸ºå±æ€§å

ç”±äºæ¯ä¸€ä¸ª Symbol å€¼éƒ½æ˜¯ä¸ç›¸ç­‰çš„ï¼Œè¿™æ„å‘³ç€ Symbol å€¼å¯ä»¥ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œç”¨äºå¯¹è±¡çš„å±æ€§åï¼Œå°±èƒ½ä¿è¯ä¸ä¼šå‡ºç°åŒåçš„å±æ€§ã€‚è¿™å¯¹äºä¸€ä¸ªå¯¹è±¡ç”±å¤šä¸ªæ¨¡å—æ„æˆçš„æƒ…å†µéå¸¸æœ‰ç”¨ï¼Œèƒ½é˜²æ­¢æŸä¸€ä¸ªé”®è¢«ä¸å°å¿ƒæ”¹å†™æˆ–è¦†ç›–ã€‚

æ¯”å¦‚åœ¨ä¸€ä¸ªç­çº§ä¸­ï¼Œå¯èƒ½ä¼šæœ‰åŒå­¦åå­—ç›¸åŒçš„æƒ…å†µï¼Œè¿™æ—¶å€™ä½¿ç”¨å¯¹è±¡æ¥æè¿°å­¦ç”Ÿä¿¡æ¯çš„æ—¶å€™ï¼Œå¦‚æœç›´æ¥ä½¿ç”¨å­¦ç”Ÿå§“åä½œä¸ºkeyä¼šæœ‰æœ‰é—®é¢˜ã€‚

```js
const grade = {
    å¼ ä¸‰: {
        address: 'xxx',
        tel: '111'
    },
    æå››: {
        address: 'yyy',
        tel: '222'
    },
    æå››: {
        address: 'zzz',
        tel: '333'
    },
}
console.log(grade)
// åªä¼šä¿ç•™æœ€åä¸€ä¸ªæå››
```

å¦‚æœä½¿ç”¨Symbolï¼ŒåŒåçš„å­¦ç”Ÿä¿¡æ¯å°±ä¸ä¼šè¢«è¦†ç›–ï¼š

```js
const stu1 = Symbol('æå››')
const stu2 = Symbol('æå››')
const grade = {
    [stu1]: {
        address: 'yyy',
        tel: '222'
    },
    [stu2]: {
        address: 'zzz',
        tel: '333'
    },
}
console.log(grade)
console.log(grade[stu1])
console.log(grade[stu2])
```

##### å±æ€§éå†

````js
const sym = Symbol('imooc')
class User {
    constructor(name) {
        this.name = name
        this[sym] = 'imooc.com'
    }
    getName() {
        return this.name + this[sym]
    }
}
const user = new User('xiecheng')
console.log(user.getName())

for (let key in user) {
    console.log(key)
}

for (let key of Object.keys(user)) {
    console.log(key)
}

for (let key of Object.getOwnPropertySymbols(user)) {
    console.log(key)
}
//æ­£å¸¸éå†å‡º
for (let key of Reflect.ownKeys(user)) {
    console.log(key)
}
````

##### æ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²

é­”æœ¯å­—ç¬¦ä¸²æŒ‡çš„æ˜¯ï¼Œåœ¨ä»£ç ä¹‹ä¸­å¤šæ¬¡å‡ºç°ã€ä¸ä»£ç å½¢æˆå¼ºè€¦åˆçš„æŸä¸€ä¸ªå…·ä½“çš„å­—ç¬¦ä¸²æˆ–è€…æ•°å€¼ã€‚é£æ ¼è‰¯å¥½çš„ä»£ç ï¼Œåº”è¯¥å°½é‡æ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²ï¼Œæ”¹ç”±å«ä¹‰æ¸…æ™°çš„å˜é‡ä»£æ›¿ã€‚

```js
function getArea(shape) {
    let area = 0
    switch (shape) {
        case 'Triangle':
            area = 1
            break
        case 'Circle':
            area = 2
            break
    }
    return area
}
console.log(getArea('Triangle'))
```

ä¸Šé¢ä»£ç ä¸­ï¼Œå­—ç¬¦ä¸²Triangleå’ŒCircleå°±æ˜¯é­”æœ¯å­—ç¬¦ä¸²ã€‚å®ƒå¤šæ¬¡å‡ºç°ï¼Œä¸ä»£ç å½¢æˆâ€œå¼ºè€¦åˆâ€ï¼Œä¸åˆ©äºå°†æ¥çš„ä¿®æ”¹å’Œç»´æŠ¤ã€‚

ä½¿ç”¨Symbolå°±å¯ä»¥å¾ˆå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ï¼š

```js
const shapeType = {
    triangle: Symbol(),
    circle: Symbol()
}

function getArea(shape) {
    let area = 0
    switch (shape) {
        case shapeType.triangle:
            area = 1
            break
        case shapeType.circle:
            area = 2
            break
    }
    return area
}
console.log(getArea(shapeType.triangle))
```

###  Set

åœ¨ JavaScript é‡Œé€šå¸¸ä½¿ç”¨ Array æˆ– Object æ¥å­˜å‚¨æ•°æ®ã€‚ä½†æ˜¯åœ¨é¢‘ç¹æ“ä½œæ•°æ®çš„è¿‡ç¨‹ä¸­æŸ¥æ‰¾æˆ–è€…ç»Ÿè®¡å¹¶éœ€è¦æ‰‹åŠ¨æ¥å®ç°ï¼Œå¹¶ä¸èƒ½ç®€å•çš„ç›´æ¥ä½¿ç”¨ã€‚ æ¯”å¦‚å¦‚ä½•ä¿è¯ Array æ˜¯å»é‡çš„ï¼Œå¦‚ä½•ç»Ÿè®¡ Object çš„æ•°æ®æ€»æ•°ç­‰ï¼Œå¿…é¡»è‡ªå·±å»æ‰‹åŠ¨å®ç°ç±»ä¼¼çš„éœ€æ±‚ï¼Œä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚ åœ¨ ES6 ä¸­ä¸ºäº†è§£å†³ä¸Šè¿°ç—›ç‚¹ï¼Œæ–°å¢äº†æ•°æ®ç»“æ„ Set å’Œ Mapï¼Œå®ƒä»¬åˆ†åˆ«å¯¹åº”ä¼ ç»Ÿæ•°æ®ç»“æ„çš„â€œé›†åˆâ€å’Œâ€œå­—å…¸â€ã€‚

> ES6 æä¾›äº†æ–°çš„æ•°æ®ç»“æ„ Setã€‚å®ƒç±»ä¼¼äºæ•°ç»„ï¼Œä½†æ˜¯æˆå‘˜çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæ²¡æœ‰é‡å¤çš„å€¼ã€‚

#### åŸºæœ¬è¯­æ³•

##### ç”Ÿæˆ Set å®ä¾‹

```js
  let s = new Set()
```

å¯ä»¥å®šä¹‰ä¸€ä¸ªç©ºçš„ Set å®ä¾‹ï¼Œä¹Ÿå¯ä»¥åœ¨å®ä¾‹åŒ–çš„åŒæ—¶ä¼ å…¥é»˜è®¤çš„æ•°æ®ã€‚

```js
  let s = new Set([1, 2, 3, 4])
```

<div class="custom-block warning"><p class="custom-block-title">æ³¨æ„</p> <p>åˆå§‹åŒ–çš„å‚æ•°å¿…é¡»æ˜¯å¯éå†çš„ï¼Œå¯ä»¥æ˜¯æ•°ç»„æˆ–è€…è‡ªå®šä¹‰éå†çš„æ•°æ®ç»“æ„ã€‚</p></div>

##### æ·»åŠ æ•°æ®

```js
  s.add('hello')
  s.add('LX')
```

æˆ–è€…

```js
  s.add('hello').add('è®¸ä¸½')
```

<div class="custom-block warning"><p class="custom-block-title">æ³¨æ„</p> <p>Set æ•°æ®ç»“æ„ä¸å…è®¸æ•°æ®é‡å¤ï¼Œæ‰€ä»¥æ·»åŠ é‡å¤çš„æ•°æ®æ˜¯æ— æ•ˆçš„</p></div>

##### åˆ é™¤æ•°æ®

åˆ é™¤æ•°æ®åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯åˆ é™¤æŒ‡å®šçš„æ•°æ®ï¼Œä¸€ç§æ˜¯åˆ é™¤å…¨éƒ¨æ•°æ®ã€‚

```js
  // åˆ é™¤æŒ‡å®šæ•°æ®
  s.delete('hello') // true
  // åˆ é™¤å…¨éƒ¨æ•°æ®
  s.clear()
```

##### ç»Ÿè®¡æ•°æ®

Set å¯ä»¥å¿«é€Ÿè¿›è¡Œç»Ÿè®¡æ•°æ®ï¼Œå¦‚æ•°æ®æ˜¯å¦å­˜åœ¨ã€æ•°æ®çš„æ€»æ•°ã€‚

```js
  // åˆ¤æ–­æ˜¯å¦åŒ…å«æ•°æ®é¡¹ï¼Œè¿”å› true æˆ– false
  s.has('hello') // true
  // è®¡ç®—æ•°æ®é¡¹æ€»æ•°
  s.size // 2
```

#### âš™ï¸åº”ç”¨åœºæ™¯

##### æ•°ç»„å»é‡

```js
let arr = [1, 2, 3, 4, 2, 3]
let s = new Set(arr)
console.log(s)
```

##### åˆå¹¶å»é‡

```js
let arr1 = [1, 2, 3, 4]
let arr2 = [2, 3, 4, 5, 6]
let s = new Set([...arr1, ...arr2])
console.log(s)
//è½¬ä¸ºæ•°ç»„
console.log([...s])
console.log(Array.from(s))
```

##### äº¤é›†

```js
let s1 = new Set(arr1)
let s2 = new Set(arr2)
let result = new Set(arr1.filter(item => s2.has(item)))
console.log(Array.from(result))
```

##### å·®é›†

```js
let arr3 = new Set(arr1.filter(item => !s2.has(item)))
let arr4 = new Set(arr2.filter(item => !s1.has(item)))
console.log(arr3)
console.log(arr4)
console.log([...arr3, ...arr4])
```

#### éå†

- keys()ï¼šè¿”å›é”®åçš„éå†å™¨
- values()ï¼šè¿”å›é”®å€¼çš„éå†å™¨
- entries()ï¼šè¿”å›é”®å€¼å¯¹çš„éå†å™¨
- forEach()ï¼šä½¿ç”¨å›è°ƒå‡½æ•°éå†æ¯ä¸ªæˆå‘˜
- for...ofï¼šå¯ä»¥ç›´æ¥éå†æ¯ä¸ªæˆå‘˜

```js
let s  =new Set(["hi","lx"]);
console.log(1,s.keys()) // Set { 'lx', 'hi' }
console.log(2,s.values()) // Set { 'hi', 'lx' }
console.log(3,s.entries()) // Set { 'hi', 'lx' }
s.forEach(item => {
    console.log(4,item) 
})

for (let item of s) {
    console.log(5,item)
}

for (let item of s.keys()) {
    console.log(6,item)
}

for (let item of s.values()) {
    console.log(7,item)
}

for (let item of s.entries()) {
    console.log(item[0], item[1])
}
```

![](https://fastly.jsdelivr.net/gh/webyang-male/yangimgs/set-1.png)

####  WeakSet

WeakSet ç»“æ„ä¸ Set ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸é‡å¤çš„å€¼çš„é›†åˆã€‚ä½†æ˜¯ï¼Œå®ƒä¸ Set æœ‰ä¸¤ä¸ªåŒºåˆ«ã€‚

WeakSet çš„æˆå‘˜åªèƒ½æ˜¯å¯¹è±¡ï¼Œè€Œä¸èƒ½æ˜¯å…¶ä»–ç±»å‹çš„å€¼ã€‚

```js
const ws = new WeakSet()
ws.add(1)
// TypeError: Invalid value used in weak set
ws.add(Symbol())
// TypeError: invalid value used in weak set
let ws = new WeakSet()
const obj1 = {
    name: 'imooc'
}
const obj2 = {
    age: 5
}
ws.add(obj1)
ws.add(obj2)
ws.delete(obj1)
console.log(ws)
console.log(ws.has(obj2))
```

<font style="color:darkorange;">WeakSet æ²¡æœ‰sizeå±æ€§ï¼Œæ²¡æœ‰åŠæ³•éå†å®ƒçš„æˆå‘˜ã€‚</font>

WeakSet ä¸­çš„å¯¹è±¡éƒ½æ˜¯å¼±å¼•ç”¨ï¼Œå³åƒåœ¾å›æ”¶æœºåˆ¶ä¸è€ƒè™‘ WeakSet å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå…¶ä»–å¯¹è±¡éƒ½ä¸å†å¼•ç”¨è¯¥å¯¹è±¡ï¼Œé‚£ä¹ˆåƒåœ¾å›æ”¶æœºåˆ¶ä¼šè‡ªåŠ¨å›æ”¶è¯¥å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ï¼Œä¸è€ƒè™‘è¯¥å¯¹è±¡è¿˜å­˜åœ¨äº WeakSet ä¹‹ä¸­ã€‚

### Map

ES6 æä¾›äº† Map æ•°æ®ç»“æ„ã€‚å®ƒç±»ä¼¼äºå¯¹è±¡ï¼Œä¹Ÿæ˜¯é”®å€¼å¯¹çš„é›†åˆï¼Œä½†æ˜¯â€œé”®â€çš„èŒƒå›´ä¸é™äºå­—ç¬¦ä¸²ï¼Œå„ç§ç±»å‹çš„å€¼ï¼ˆåŒ…æ‹¬å¯¹è±¡ï¼‰éƒ½å¯ä»¥å½“ä½œé”®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒObject ç»“æ„æä¾›äº†â€œå­—ç¬¦ä¸²â€”å€¼â€çš„å¯¹åº”ï¼ŒMap ç»“æ„æä¾›äº†â€œå€¼â€”å€¼â€çš„å¯¹åº”ï¼Œæ˜¯ä¸€ç§æ›´å®Œå–„çš„ Hash ç»“æ„å®ç°ã€‚å¦‚æœä½ éœ€è¦â€œé”®å€¼å¯¹â€çš„æ•°æ®ç»“æ„ï¼ŒMap æ¯” Object æ›´åˆé€‚ã€‚

#### å®ä¾‹åŒ–

```js
  let map = new Map([iterable])
```

Iterable å¯ä»¥æ˜¯ä¸€ä¸ªæ•°ç»„æˆ–è€…å…¶ä»– iterable å¯¹è±¡ï¼Œå…¶å…ƒç´ ä¸ºé”®å€¼å¯¹(ä¸¤ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œä¾‹å¦‚: [[ 1, 'one' ], [ 2, 'two' ]])ã€‚ æ¯ä¸ªé”®å€¼å¯¹éƒ½ä¼šæ·»åŠ åˆ°æ–°çš„ Mapã€‚null ä¼šè¢«å½“åš undefinedã€‚

#### æ·»åŠ æ•°æ®

```js
  let keyObj = {}
  let keyFunc = function() {}
  let keyString = 'a string'

  // æ·»åŠ é”®
  map.set(keyString, "å’Œé”®'a string'å…³è”çš„å€¼")
  map.set(keyObj, 'å’Œé”®keyObjå…³è”çš„å€¼')
  map.set(keyFunc, 'å’Œé”®keyFuncå…³è”çš„å€¼')
```

````js
let m = new Map()
let obj = {
    name: 'imooc'
}
m.set(obj, 'es')
console.log(m.get(obj))//es
m.delete(obj)
console.log(m)// Map(0)
````

#### åˆ é™¤æ•°æ®

```js
  // åˆ é™¤æŒ‡å®šçš„æ•°æ®
  map.delete(keyObj)
  // åˆ é™¤æ‰€æœ‰æ•°æ®
  map.clear()
```

#### ç»Ÿè®¡æ•°æ®

```js
  // ç»Ÿè®¡æ‰€æœ‰ key-value çš„æ€»æ•°
  console.log(map.size) //2
  // åˆ¤æ–­æ˜¯å¦æœ‰ key-value
  console.log(map.has(keyObj)) // true
```

````js
let map = new Map([
    ['name', 'tb'],
    ['age', 18]
])
console.log(map.size)//2
console.log(map.has('name'))//true
console.log(map.get('age'))//18
map.set('name', 'zhangsan')
map.delete('name')
console.log(map)//Map(1)Â {'age' => 5}
````

#### æŸ¥è¯¢æ•°æ®

get() æ–¹æ³•è¿”å›æŸä¸ª Map å¯¹è±¡ä¸­çš„ä¸€ä¸ªæŒ‡å®šå…ƒç´ 

```js
  console.log(map.get(keyObj)) // å’Œé”®keyObjå…³è”çš„å€¼
```

#### éå†æ–¹å¼

- keys() è¿”å›ä¸€ä¸ªæ–°çš„ Iterator å¯¹è±¡ã€‚å®ƒåŒ…å«æŒ‰ç…§é¡ºåºæ’å…¥ Map å¯¹è±¡ä¸­æ¯ä¸ªå…ƒç´ çš„ key å€¼
- values() æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„ Iterator å¯¹è±¡ã€‚å®ƒåŒ…å«æŒ‰é¡ºåºæ’å…¥Mapå¯¹è±¡ä¸­æ¯ä¸ªå…ƒç´ çš„ value å€¼
- entries() æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„åŒ…å« [key, value] å¯¹çš„ Iterator ? å¯¹è±¡ï¼Œè¿”å›çš„è¿­ä»£å™¨çš„è¿­ä»£é¡ºåºä¸ Map å¯¹è±¡çš„æ’å…¥é¡ºåºç›¸åŒ
- forEach() æ–¹æ³•å°†ä¼šä»¥æ’å…¥é¡ºåºå¯¹ Map å¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªé”®å€¼å¯¹æ‰§è¡Œä¸€æ¬¡å‚æ•°ä¸­æä¾›çš„å›è°ƒå‡½æ•°
- for...of å¯ä»¥ç›´æ¥éå†æ¯ä¸ªæˆå‘˜

```js
   map.forEach((value, key) => console.log(value, key))

   for (let [key, value] of map) {
       console.log(key, value)
   }

   for (let key of map.keys()) {
       console.log(key)
   }

   for (let value of map.values()) {
       console.log(value)
   }

   for (let [key, value] of map.entries()) {
       console.log(key, value)
   }
```

<font style="color:gold;">å…¶å® Object ä¹Ÿæ˜¯æŒ‰é”®å€¼å¯¹å­˜å‚¨å’Œè¯»å–çš„ï¼Œé‚£ä¹ˆä»–ä¿©ä¹‹é—´é™¤äº†æˆ‘ä»¬ä¹‹å‰è¯´çš„åŒºåˆ«ä»¥å¤–è¿˜æœ‰å…¶ä»–çš„å—ï¼Ÿ</font>

- **é”®çš„ç±»å‹**

  ä¸€ä¸ªObjectçš„é”®åªèƒ½æ˜¯å­—ç¬¦ä¸²æˆ–è€… Symbolsï¼Œä½†ä¸€ä¸ª Map çš„é”®å¯ä»¥æ˜¯ä»»æ„å€¼ï¼ŒåŒ…æ‹¬å‡½æ•°ã€å¯¹è±¡ã€åŸºæœ¬ç±»å‹ã€‚

- **é”®çš„é¡ºåº**

  Map ä¸­çš„é”®å€¼æ˜¯æœ‰åºçš„ï¼Œè€Œæ·»åŠ åˆ°å¯¹è±¡ä¸­çš„é”®åˆ™ä¸æ˜¯ã€‚å› æ­¤ï¼Œå½“å¯¹å®ƒè¿›è¡Œéå†æ—¶ï¼ŒMap å¯¹è±¡æ˜¯æŒ‰æ’å…¥çš„é¡ºåºè¿”å›é”®å€¼ã€‚

- **é”®å€¼å¯¹çš„ç»Ÿè®¡**

  ä½ å¯ä»¥é€šè¿‡ size å±æ€§ç›´æ¥è·å–ä¸€ä¸ª Map çš„é”®å€¼å¯¹ä¸ªæ•°ï¼Œè€Œ Object çš„é”®å€¼å¯¹ä¸ªæ•°åªèƒ½æ‰‹åŠ¨è®¡ç®—ã€‚

- **é”®å€¼å¯¹çš„éå†**

  Map å¯ç›´æ¥è¿›è¡Œè¿­ä»£ï¼Œè€Œ Object çš„è¿­ä»£éœ€è¦å…ˆè·å–å®ƒçš„é”®æ•°ç»„ï¼Œç„¶åå†è¿›è¡Œè¿­ä»£ã€‚

- **æ€§èƒ½**

  Map åœ¨æ¶‰åŠé¢‘ç¹å¢åˆ é”®å€¼å¯¹çš„åœºæ™¯ä¸‹ä¼šæœ‰äº›æ€§èƒ½ä¼˜åŠ¿ã€‚
  

  <font style="color:deepskyblue;">mapåº”ç”¨åœºæ™¯ï¼šåˆ¤æ–­å¯¹è±¡æœ‰æ²¡æœ‰æŸä¸ªkeyæœ‰hasæ–¹æ³•ã€sizeæ–¹æ³•ç›´æ¥è·å–å¯¹è™¾å¹²å±æ€§çš„ä¸ªæ•°ã€å±æ€§åçš„ç§ç±»æ›´å¤šæ ·ã€æ€§èƒ½æ¯”å¯¹è±¡æ›´å¥½</font>

#### WeekMap

WeakMapç»“æ„ä¸Mapç»“æ„ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ç”¨äºç”Ÿæˆé”®å€¼å¯¹çš„é›†åˆã€‚

```js
// WeakMap å¯ä»¥ä½¿ç”¨ set æ–¹æ³•æ·»åŠ æˆå‘˜
const wm1 = new WeakMap()
const key = {
    foo: 1
}
wm1.set(key, 2)
wm1.get(key) // 2

// WeakMap ä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„ï¼Œ
// ä½œä¸ºæ„é€ å‡½æ•°çš„å‚æ•°
const k1 = [1, 2, 3]
const k2 = [4, 5, 6]
const wm2 = new WeakMap([
    [k1, 'foo'],
    [k2, 'bar']
])
wm2.get(k2) // "bar"
```

WeakMapä¸Mapçš„åŒºåˆ«æœ‰ä¸¤ç‚¹ã€‚

- WeakMapåªæ¥å—å¯¹è±¡ä½œä¸ºé”®åï¼ˆnullé™¤å¤–ï¼‰ï¼Œä¸æ¥å—å…¶ä»–ç±»å‹çš„å€¼ä½œä¸ºé”®åã€‚

```js
const map = new WeakMap()
map.set(1, 2)
// TypeError: 1 is not an object!
map.set(Symbol(), 2)
// TypeError: Invalid value used as weak map key
map.set(null, 2)
// TypeError: Invalid value used as weak map key
```

- WeakMapçš„é”®åæ‰€æŒ‡å‘çš„å¯¹è±¡ï¼Œä¸è®¡å…¥åƒåœ¾å›æ”¶æœºåˆ¶ã€‚

  

  ````js
  let wm = new WeakMap()
  let elem = document.getElementsByTagName('h1')
  wm.set(elem, 'info')
  console.log(wm.get(elem))
  ````

<em>è¿™é‡Œelemè¢«å¼•ç”¨äº†ä¸€æ¬¡ï¼Œåƒåœ¾å›æ”¶æœºåˆ¶è®°å½•elemè¿™ä¸ªèŠ‚ç‚¹å¼•ç”¨æ¬¡æ•°ä¸€æ¬¡ï¼Œweakmapæ˜¯å¼±å¼•ç”¨ï¼Œwm.set(elem,'info'),è¿™é‡Œåˆå¼•ç”¨ä¸€æ¬¡ï¼Œä½†ä¸ä¼šè¿›å…¥åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå¼•ç”¨æ¬¡æ•°ä¸ä¼šå¢åŠ ï¼Œæ‰€ä»¥elemè¿™ä¸ªå…ƒç´ æ€»çš„å¼•ç”¨æ¬¡æ•°æ˜¯ä¸€æ¬¡ï¼Œå¦‚æœæœ‰ä¸€å¤©ï¼Œè¿™ä¸ªå…ƒç´ è¢«åˆ æ‰ï¼Œåƒåœ¾å›æ”¶æœºåˆ¶å¼•ç”¨æ¬¡æ•°å˜ä¸º0ï¼Œweakmapæ˜¯å¼±å¼•ç”¨ï¼Œå¯¹è¢«åˆ é™¤å…ƒç´ çš„å¼•ç”¨å¹¶ä¸ä¼šå½±å“åƒåœ¾å›æ”¶æœºåˆ¶çš„è®°å½•æ¬¡æ•°ï¼Œæ­¤æ—¶æ˜¯0ï¼Œæ‰€ä»¥è¿™é‡Œçš„elemå¯¹è±¡è¢«å›æ”¶ï¼Œå¯¹åº”weakmapé‡Œé¢çš„é”®å€¼å¯¹ä¹Ÿä¼šæ¶ˆå¤±ï¼Œæ‰€ä»¥weakmapè¿™ç§æ•°æ®ç»“æ„æ˜¯æœ‰åŠ©äºé˜²æ­¢å†…å­˜æ³„æ¼çš„ï¼Œè¿™å°±æ˜¯weakmapçš„åº”ç”¨åœºæ™¯</em>

ğŸ“WeakMapï¼šé”®ååªæ”¯æŒå¼•ç”¨ç±»å‹ï¼ˆæ•°ç»„ã€å¯¹è±¡ã€functionï¼‰ï¼Œå¯¹å¯¹è±¡çš„å¼•ç”¨æ˜¯å¼±å¼•ç”¨

â€‹	ä¸æ”¯æŒclearã€sizeæ–¹æ³•ã€ä¸èƒ½éå†ã€ä¹Ÿæ˜¯å¼±å¼•ç”¨ç±»å‹

### Stringæ‰©å±•

#### Unicodeè¡¨ç¤ºæ³•

ES6 åŠ å¼ºäº†å¯¹ Unicode çš„æ”¯æŒï¼Œå…è®¸é‡‡ç”¨\uxxxxå½¢å¼è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­xxxxè¡¨ç¤ºå­—ç¬¦çš„ Unicode ç ç‚¹ã€‚

```js
"\u0061"
// "a"
```

ä½†æ˜¯ï¼Œè¿™ç§è¡¨ç¤ºæ³•åªé™äºç ç‚¹åœ¨\u0000~\uFFFFä¹‹é—´çš„å­—ç¬¦ã€‚è¶…å‡ºè¿™ä¸ªèŒƒå›´çš„å­—ç¬¦ï¼Œå¿…é¡»ç”¨ä¸¤ä¸ªåŒå­—èŠ‚çš„å½¢å¼è¡¨ç¤ºã€‚

```js
"\uD842\uDFB7"
// "ğ ®·"

"\u20BB7"
// " 7"
```

ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœç›´æ¥åœ¨\uåé¢è·Ÿä¸Šè¶…è¿‡0xFFFFçš„æ•°å€¼ï¼ˆæ¯”å¦‚\u20BB7ï¼‰ï¼ŒJavaScript ä¼šç†è§£æˆ\u20BB+7ã€‚ç”±äº\u20BBæ˜¯ä¸€ä¸ªä¸å¯æ‰“å°å­—ç¬¦ï¼Œæ‰€ä»¥åªä¼šæ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼ï¼Œåé¢è·Ÿç€ä¸€ä¸ª7ã€‚

ES6 å¯¹è¿™ä¸€ç‚¹åšå‡ºäº†æ”¹è¿›ï¼Œåªè¦å°†ç ç‚¹æ”¾å…¥å¤§æ‹¬å·ï¼Œå°±èƒ½æ­£ç¡®è§£è¯»è¯¥å­—ç¬¦ã€‚

```js
"\u{20BB7}"
// "ğ ®·"
```

æœ‰äº†è¿™ç§è¡¨ç¤ºæ³•ä¹‹åï¼ŒJavaScript å…±æœ‰ 6 ç§æ–¹æ³•å¯ä»¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ã€‚

```js
'\z' === 'z' // true
'\172' === 'z' // true
'\x7A' === 'z' // true
'\u007A' === 'z' // true
'\u{7A}' === 'z' // true
```

#### éå†å™¨æ¥å£

ES6 ä¸ºå­—ç¬¦ä¸²æ·»åŠ äº†éå†å™¨æ¥å£ï¼Œè¯¦è§Iteratorï¼Œä½¿å¾—å­—ç¬¦ä¸²å¯ä»¥è¢«for...ofå¾ªç¯éå†ã€‚

```js
for (let item of 'CHINA') {
    console.log(item)
}
```

#### <font style="color:darkorange;">æ¨¡æ¿å­—ç¬¦ä¸²</font>

åœ¨æ¨¡æ¿å­—ç¬¦ä¸²è¯­å¥ä¸­å¯ä»¥ä»»æ„æ’å…¥å˜é‡æˆ–è€…è¡¨è¾¾å¼ï¼Œåªè¦ç”¨[``${}``]åŒ…èµ·æ¥å°±å¥½ã€‚

<div class="custom-block warning"><p class="custom-block-title">æ³¨æ„</p> <p>è¿™é‡Œçš„ç¬¦å·æ˜¯åå¼•å·ï¼Œä¹Ÿå°±æ˜¯æ•°å­—é”® 1 å·¦è¾¹çš„é”®ï¼Œä¸æ˜¯å•å¼•å·æˆ–è€…åŒå¼•å·</p></div>

##### æ¢è¡Œ

è¿™æ ·å°±å¯ä»¥è½»æ¾è§£å†³å­—ç¬¦ä¸²åŒ…å«å˜é‡æˆ–è€…è¡¨è¾¾å¼çš„é—®é¢˜äº†ï¼Œå¯¹äºå¤šè¡Œçš„å­—ç¬¦ä¸²ï¼Œä¹‹å‰æ˜¯è¿™æ ·å¤„ç†

```js
console.log('string text line 1\n' +
    'string text line 2')
// "string text line 1
// string text line 2"
```

ç°åœ¨å¯ä»¥è¿™æ ·åšäº†

```js
console.log(`string text line 1
string text line 2`)
// "string text line 1
// string text line 2"
```

##### Tag Literals	

å‰é¢çš„å­—ç¬¦ä¸²å­—é¢é‡è§£å†³äº†å­—ç¬¦ä¸²æ‹¼æ¥çš„é—®é¢˜ï¼Œå¯¹äºåŒ…å«å¤æ‚é€»è¾‘çš„å­—ç¬¦ä¸²å¹¶ä¸æ˜¯ç®€å•çš„è¡¨è¾¾å¼èƒ½æå®šçš„ã€‚æ‰€ä»¥éœ€è¦å¦ä¸€ç§è§£å†³æ–¹æ¡ˆï¼šTag Literals

```js
var retailPrice = 20
var wholesalePrice = 16
var type = 'retail'

var showTxt = ''

if (type === 'retail') {
    showTxt += 'æ‚¨æ­¤æ¬¡çš„è´­ä¹°å•ä»·æ˜¯ï¼š' + retailPrice
} else {
    showTxt += 'æ‚¨æ­¤æ¬¡çš„æ‰¹å‘ä»·æ˜¯ï¼š' + wholesalePrice
}
```

ç°åœ¨å¯ä»¥å®šä¹‰ä¸€ä¸ª Tag å‡½æ•°ï¼Œç„¶åç”¨è¿™ä¸ª Tag å‡½æ•°æ¥å……å½“ä¸€ä¸ªæ¨¡æ¿å¼•æ“ï¼š

```js
function Price(strings, type) {
    let s1 = strings[0]
    const retailPrice = 20
    const wholesalePrice = 16
    let txt = ''
    if (type === 'retail') {
        txt = `è´­ä¹°å•ä»·æ˜¯ï¼š${retailPrice}` 
    } else {
        txt = `æ‰¹å‘ä»·æ˜¯ï¼š${wholesalePrice}` 
    }
    return `${s1}${txt}` 
}

let showTxt = Price `æ‚¨æ­¤æ¬¡çš„${'retail'}` 

console.log(showTxt) //æ‚¨æ­¤æ¬¡çš„è´­ä¹°å•ä»·æ˜¯ï¼š20
```

> TIP
>
> strings å‚æ•°æŒ‡çš„æ˜¯ Tag å‡½æ•°åé¢è¢«å˜é‡åˆ†å‰²å¼€çš„å­—ç¬¦ä¸²é›†åˆï¼Œtype å‚æ•°æ˜¯å¯¹åº”ç¬¬ä¸€ä¸ªå˜é‡ï¼ŒTag å‡½æ•°å¯ä»¥æœ‰å¤šä¸ª type ç±»ä¼¼çš„å‚æ•°

#### æ‰©å±•æ–¹æ³•

##### String.prototype.fromCodePoint()

ç”¨äºä» Unicode ç ç‚¹è¿”å›å¯¹åº”å­—ç¬¦ï¼Œå¹¶ä¸”å¯ä»¥è¯†åˆ«å¤§äº0xFFFFçš„å­—ç¬¦ã€‚

```js
// ES5
console.log(String.fromCharCode(0x20BB7))	//æ‰“å°æœªçŸ¥ç¬¦å·,å› ä¸ºes5æœ€å¤§æ”¯æŒç ç‚¹ä¸è¶…è¿‡FFFF

// ES6
console.log(String.fromCodePoint(0x20BB7))
```

##### String.prototype.includes()

ES5ä¸­å¯ä»¥ä½¿ç”¨indexOfæ–¹æ³•æ¥åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ…å«åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼ŒindexOfè¿”å›å‡ºç°çš„ä¸‹æ ‡ä½ç½®ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›-1ã€‚

```js
const str = 'imooc'

console.log(str.indexOf('mo'))
```

ES6æä¾›äº†includesæ–¹æ³•æ¥åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ…å«åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œè¿”å›booleanç±»å‹çš„å€¼ã€‚

```js
const str = 'imooc'

console.log(str.includes('mo'))
```

##### String.prototype.startsWith()

åˆ¤æ–­å‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨åŸå­—ç¬¦ä¸²çš„å¤´éƒ¨, è¿”å›booleanç±»å‹çš„å€¼ã€‚

```js
const str = 'imooc'

console.log(str.startsWith('im'))
```

##### String.prototype.endsWith()

åˆ¤æ–­å‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨åŸå­—ç¬¦ä¸²çš„å°¾éƒ¨, è¿”å›booleanç±»å‹çš„å€¼ã€‚

```js
const str = 'imooc'

console.log(str.endsWith('mooc'))
```

##### String.prototype.repeat()

repeatæ–¹æ³•è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå°†åŸå­—ç¬¦ä¸²é‡å¤næ¬¡ã€‚

```js
const str = 'imooc'

const newStr = str.repeat(10)

console.log(newStr)
```

###  RegExp

#### yä¿®é¥°ç¬¦

ES6ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ·»åŠ äº†yä¿®é¥°ç¬¦ï¼Œå«åšâ€œç²˜è¿â€ï¼ˆstickyï¼‰ä¿®é¥°ç¬¦ã€‚

yä¿®é¥°ç¬¦çš„ä½œç”¨ä¸gä¿®é¥°ç¬¦ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å…¨å±€åŒ¹é…ï¼Œåä¸€æ¬¡åŒ¹é…éƒ½ä»ä¸Šä¸€æ¬¡åŒ¹é…æˆåŠŸçš„ä¸‹ä¸€ä¸ªä½ç½®å¼€å§‹ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œgä¿®é¥°ç¬¦åªè¦å‰©ä½™ä½ç½®ä¸­å­˜åœ¨åŒ¹é…å°±å¯ï¼Œè€Œyä¿®é¥°ç¬¦ç¡®ä¿åŒ¹é…å¿…é¡»ä»å‰©ä½™çš„ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹ï¼Œè¿™ä¹Ÿå°±æ˜¯â€œç²˜è¿â€çš„æ¶µä¹‰ã€‚

```js
const s = 'aaa_aa_a'
const r1 = /a+/g
const r2 = /a+/y

r1.exec(s) // ["aaa"]
r2.exec(s) // ["aaa"]

r1.exec(s) // ["aa"]
r2.exec(s) // null
```

ä¸Šé¢ä»£ç æœ‰ä¸¤ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œä¸€ä¸ªä½¿ç”¨gä¿®é¥°ç¬¦ï¼Œå¦ä¸€ä¸ªä½¿ç”¨yä¿®é¥°ç¬¦ã€‚è¿™ä¸¤ä¸ªæ­£åˆ™è¡¨è¾¾å¼å„æ‰§è¡Œäº†ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸¤è€…è¡Œä¸ºç›¸åŒï¼Œå‰©ä½™å­—ç¬¦ä¸²éƒ½æ˜¯`_aa_a`ã€‚ç”±äºgä¿®é¥°æ²¡æœ‰ä½ç½®è¦æ±‚ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡æ‰§è¡Œä¼šè¿”å›ç»“æœï¼Œè€Œyä¿®é¥°ç¬¦è¦æ±‚åŒ¹é…å¿…é¡»ä»`å¤´éƒ¨`å¼€å§‹ï¼Œæ‰€ä»¥è¿”å›nullã€‚

å¦‚æœæ”¹ä¸€ä¸‹æ­£åˆ™è¡¨è¾¾å¼ï¼Œä¿è¯æ¯æ¬¡éƒ½èƒ½å¤´éƒ¨åŒ¹é…ï¼Œyä¿®é¥°ç¬¦å°±ä¼šè¿”å›ç»“æœäº†ã€‚

```js
const s = 'aaa_aa_a'
const r = /a+_/y

r.exec(s) // ["aaa_"]
r.exec(s) // ["aa_"]
```

```js
const s = 'aaa_aa_a'
const r = /a+_/y

r.exec(s) // ["aaa_"]
r.exec(s) // ["aa_"]
```

ä¸Šé¢ä»£ç æ¯æ¬¡åŒ¹é…ï¼Œéƒ½æ˜¯ä»å‰©ä½™å­—ç¬¦ä¸²çš„å¤´éƒ¨å¼€å§‹ã€‚

ä½¿ç”¨lastIndexå±æ€§ï¼Œå¯ä»¥æ›´å¥½åœ°è¯´æ˜yä¿®é¥°ç¬¦ã€‚

```js
const regexp = /a/g

// æŒ‡å®šä»2å·ä½ç½®ï¼ˆyï¼‰å¼€å§‹åŒ¹é…
regexp.lastIndex = 2

// åŒ¹é…æˆåŠŸ
const match = regexp.exec('xaya')

// åœ¨3å·ä½ç½®åŒ¹é…æˆåŠŸ
console.log(match.index) // 3

// ä¸‹ä¸€æ¬¡åŒ¹é…ä»4å·ä½å¼€å§‹
console.log(regexp.lastIndex) // 4

// 4å·ä½å¼€å§‹åŒ¹é…å¤±è´¥
regexp.exec('xaxa') // null
```

ä¸Šé¢ä»£ç ä¸­ï¼ŒlastIndexå±æ€§æŒ‡å®šæ¯æ¬¡æœç´¢çš„å¼€å§‹ä½ç½®ï¼Œgä¿®é¥°ç¬¦ä»è¿™ä¸ªä½ç½®å¼€å§‹å‘åæœç´¢ï¼Œç›´åˆ°å‘ç°åŒ¹é…ä¸ºæ­¢ã€‚

yä¿®é¥°ç¬¦åŒæ ·éµå®ˆlastIndexå±æ€§ï¼Œä½†æ˜¯è¦æ±‚å¿…é¡»åœ¨lastIndexæŒ‡å®šçš„ä½ç½®å‘ç°åŒ¹é…ã€‚

```js
const regexp = /a/y

// æŒ‡å®šä»2å·ä½ç½®å¼€å§‹åŒ¹é…
regexp.lastIndex = 2

// ä¸æ˜¯ç²˜è¿ï¼ŒåŒ¹é…å¤±è´¥
regexp.exec('xaya') // null

// æŒ‡å®šä»3å·ä½ç½®å¼€å§‹åŒ¹é…
regexp.lastIndex = 3

// 3å·ä½ç½®æ˜¯ç²˜è¿ï¼ŒåŒ¹é…æˆåŠŸ
const match = regexp.exec('xaxa')
console.log(match.index) // 3
console.log(regexp.lastIndex) // 4
```

è¿›ä¸€æ­¥è¯´ï¼Œyä¿®é¥°ç¬¦å·éšå«äº†å¤´éƒ¨åŒ¹é…çš„æ ‡å¿—^ã€‚

```js
const reg = /b/y
reg.exec('aba')
// null
console.log(reg.lastIndex)
```

> TIP
>
> sticky æ¨¡å¼åœ¨æ­£åˆ™åŒ¹é…è¿‡ç¨‹ä¸­åªä¼šå½±å“ä¸¤ä»¶äº‹ï¼š
>
> - åŒ¹é…å¿…é¡»ä» re.lastIndex å¼€å§‹ï¼ˆç›¸å½“äºæ­£åˆ™è¡¨è¾¾ä¸­çš„ ^ï¼‰
> - å¦‚æœåŒ¹é…åˆ°ä¼šä¿®æ”¹ re.lastIndexï¼ˆç›¸å½“äº g æ¨¡å¼ï¼‰

#### uä¿®é¥°ç¬¦

ES6ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ·»åŠ äº†uä¿®é¥°ç¬¦ï¼Œå«ä¹‰ä¸ºâ€œUnicodeæ¨¡å¼â€ï¼Œç”¨æ¥æ­£ç¡®å¤„ç†å¤§äº `\uFFFF` çš„Unicodeå­—ç¬¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼šæ­£ç¡®å¤„ç†å››ä¸ªå­—èŠ‚çš„UTF-16ç¼–ç ã€‚

````js
// uä¿®é¥°ç¬¦ unicode
// \u0000~\uffff
const str = '\uD842\uDFB7' // è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦
console.log(/^\uD842/.test(str)) // es5 true
console.log(/^\uD842/u.test(str)) // es6 false
````

ä¸Šé¢ä»£ç ä¸­ï¼Œ `\uD83D\uDC2A` æ˜¯ä¸€ä¸ªå››ä¸ªå­—èŠ‚çš„UTF-16ç¼–ç ï¼Œä»£è¡¨ä¸€ä¸ªå­—ç¬¦ "ğŸª"ã€‚ä½†æ˜¯ï¼ŒES5ä¸æ”¯æŒå››ä¸ªå­—èŠ‚çš„UTF-16ç¼–ç ï¼Œä¼šå°†å…¶è¯†åˆ«ä¸ºä¸¤ä¸ªå­—ç¬¦ï¼Œå¯¼è‡´ç¬¬äºŒè¡Œä»£ç ç»“æœä¸ºtrueã€‚åŠ äº†uä¿®é¥°ç¬¦ä»¥åï¼ŒES6å°±ä¼šè¯†åˆ«å…¶ä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ç¬¬ä¸€è¡Œä»£ç ç»“æœä¸ºfalseã€‚

ä¸€æ—¦åŠ ä¸Šuä¿®é¥°ç¬¦å·ï¼Œå°±ä¼šä¿®æ”¹ä¸‹é¢è¿™äº›æ­£åˆ™è¡¨è¾¾å¼çš„è¡Œä¸º:

**(1) ç‚¹å­—ç¬¦**

ç‚¹ï¼ˆ.ï¼‰å­—ç¬¦åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå«ä¹‰æ˜¯é™¤äº†æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦ã€‚å¯¹äºç ç‚¹å¤§äº 0xFFFF çš„ Unicode å­—ç¬¦ï¼Œç‚¹å­—ç¬¦ä¸èƒ½è¯†åˆ«ï¼Œå¿…é¡»åŠ ä¸Šuä¿®é¥°ç¬¦ã€‚

````js
const str = '\uD842\uDFB7' // è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦

// .é™¤äº†æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦
console.log(/^.$/.test(str)) // false
console.log(/^.$/u.test(str)) // true
````

ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœä¸æ·»åŠ uä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼å°±ä¼šè®¤ä¸ºå­—ç¬¦ä¸²ä¸ºä¸¤ä¸ªå­—ç¬¦ï¼Œä»è€ŒåŒ¹é…å¤±è´¥ã€‚

**(2) Unicodeå­—ç¬¦è¡¨ç¤ºæ³•**

ES6æ–°å¢äº†ä½¿ç”¨å¤§æ‹¬å·è¡¨ç¤ºUnicodeå­—ç¬¦ï¼Œè¿™ç§è¡¨ç¤ºæ³•åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å¿…é¡»åŠ ä¸Šuä¿®é¥°ç¬¦ï¼Œæ‰èƒ½è¯†åˆ«ã€‚

````js
console.log(/\u{61}/.test('a')) // false

console.log(/\u{61}/u.test('a')) // true
````

ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœä¸åŠ uä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼æ— æ³•è¯†åˆ«\u{61}è¿™ç§è¡¨ç¤ºæ³•ï¼Œåªä¼šè®¤ä¸ºè¿™åŒ¹é…61ä¸ªè¿ç»­çš„uã€‚

**(3) é‡è¯**

ä½¿ç”¨uä¿®é¥°ç¬¦åï¼Œæ‰€æœ‰é‡è¯éƒ½ä¼šæ­£ç¡®è¯†åˆ«ç ç‚¹å¤§äº0xFFFFçš„Unicodeå­—ç¬¦ã€‚

```js
console.log(/ğ ®·{2}/.test('ğ ®·ğ ®·')) // false

console.log(/ğ ®·{2}/u.test('ğ ®·ğ ®·')) // true
```

åªæœ‰åœ¨ä½¿ç”¨uä¿®é¥°ç¬¦çš„æƒ…å†µä¸‹ï¼ŒUnicodeè¡¨è¾¾å¼å½“ä¸­çš„å¤§æ‹¬å·æ‰ä¼šè¢«æ­£ç¡®è§£è¯»ï¼Œå¦åˆ™ä¼šè¢«è§£è¯»ä¸ºé‡è¯ã€‚

```js
/^\u{3}$/.test('uuu') // true
```

ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äºæ­£åˆ™è¡¨è¾¾å¼æ²¡æœ‰uä¿®é¥°ç¬¦ï¼Œæ‰€ä»¥å¤§æ‹¬å·è¢«è§£è¯»ä¸ºé‡è¯ã€‚åŠ ä¸Šuä¿®é¥°ç¬¦ï¼Œå°±ä¼šè¢«è§£è¯»ä¸ºUnicodeè¡¨è¾¾å¼ã€‚

```js
/\u{20BB7}{2}/u.test('ğ ®·ğ ®·') // true
```

ä½¿ç”¨ u ä¿®é¥°ç¬¦ä¹‹å Unicode è¡¨è¾¾å¼+é‡è¯ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚

**(4) é¢„å®šä¹‰æ¨¡å¼**

uä¿®é¥°ç¬¦ä¹Ÿå½±å“åˆ°é¢„å®šä¹‰æ¨¡å¼ï¼Œèƒ½å¦æ­£ç¡®è¯†åˆ«ç ç‚¹å¤§äº0xFFFFçš„Unicodeå­—ç¬¦ã€‚

```js
/^\S$/.test('ğ ®·') // false

/^\S$/u.test('ğ ®·') // true
```

ä¸Šé¢ä»£ç çš„\Sæ˜¯é¢„å®šä¹‰æ¨¡å¼ï¼ŒåŒ¹é…æ‰€æœ‰ä¸æ˜¯ç©ºæ ¼çš„å­—ç¬¦ã€‚åªæœ‰åŠ äº†uä¿®é¥°ç¬¦ï¼Œå®ƒæ‰èƒ½æ­£ç¡®åŒ¹é…ç ç‚¹å¤§äº0xFFFFçš„Unicodeå­—ç¬¦ã€‚

åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå¯ä»¥å†™å‡ºä¸€ä¸ªæ­£ç¡®è¿”å›å­—ç¬¦ä¸²é•¿åº¦çš„å‡½æ•°ã€‚

```js
function codePointLength(text) {
    const result = text.match(/[\s\S]/gu)
    return result ? result.length : 0
}

const s = 'ğ ®·ğ ®·'

s.length // 4
codePointLength(s) // 2
```

**(5) iä¿®é¥°ç¬¦**

æœ‰äº›Unicodeå­—ç¬¦çš„ç¼–ç ä¸åŒï¼Œä½†æ˜¯å­—å‹å¾ˆç›¸è¿‘ï¼Œæ¯”å¦‚ï¼Œ\u004Bä¸\u212Aéƒ½æ˜¯å¤§å†™çš„Kã€‚

```js
/[a-z]/i.test('\u212A') // false

/[a-z]/iu.test('\u212A') // true
```

ä¸Šé¢ä»£ç ä¸­ï¼Œä¸åŠ uä¿®é¥°ç¬¦ï¼Œå°±æ— æ³•è¯†åˆ«éè§„èŒƒçš„Kå­—ç¬¦ã€‚

### Number                æ•°å€¼çš„æ‰©å±•

åè¿›åˆ¶è½¬åŒ–ä¸ºäºŒè¿›åˆ¶

````js
const a = 5 // 101

console.log(a.toString(2))
````

åè¿›åˆ¶è½¬åŒ–ä¸ºäºŒè¿›åˆ¶

````js
const b = 101

console.log(parseInt(b, 2))
````

ES6 æä¾›äº†äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶æ•°å€¼çš„æ–°çš„å†™æ³•ï¼Œåˆ†åˆ«ç”¨å‰ç¼€0bï¼ˆæˆ–0Bï¼‰å’Œ0oï¼ˆæˆ–0Oï¼‰è¡¨ç¤ºã€‚

```js
const a = 0B0101
console.log(a)

const b = 0O777
console.log(b)
```

#### æ–°å¢æ–¹æ³•

##### Number.isFinite()

ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªæ•°å€¼æ˜¯å¦ä¸ºæœ‰é™çš„ï¼ˆfiniteï¼‰ï¼Œå³ä¸æ˜¯Infinityã€‚

```js
Number.isFinite(15) // true
Number.isFinite(0.8) // true
Number.isFinite(NaN) // false
Number.isFinite(Infinity) // false
Number.isFinite(-Infinity) // false
Number.isFinite('foo') // false
Number.isFinite('15') // false
Number.isFinite(true) // false
```

##### Number.isNaN()

ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦ä¸ºNaNã€‚

```js
Number.isNaN(NaN) // true
Number.isNaN(15) // false
Number.isNaN('15') // false
Number.isNaN(true) // false
Number.isNaN(9 / NaN) // true
Number.isNaN('true' / 0) // true
Number.isNaN('true' / 'true') // true
```

##### Number.parseInt()

ES6 å°†å…¨å±€æ–¹æ³•parseInt()ç§»æ¤åˆ°Numberå¯¹è±¡ä¸Šé¢ï¼Œè¡Œä¸ºå®Œå…¨ä¿æŒä¸å˜ã€‚ è¿™æ ·åšçš„ç›®çš„ï¼Œæ˜¯é€æ­¥å‡å°‘å…¨å±€æ€§æ–¹æ³•ï¼Œä½¿å¾—è¯­è¨€é€æ­¥æ¨¡å—åŒ–ã€‚

```js
// ES5çš„å†™æ³•
parseInt('12.34') // 12

// ES6çš„å†™æ³•
Number.parseInt('12.34') // 12
```

##### Number.parseFloat()

ES6 å°†å…¨å±€æ–¹æ³•parseFloat()ç§»æ¤åˆ°Numberå¯¹è±¡ä¸Šé¢ï¼Œè¡Œä¸ºå®Œå…¨ä¿æŒä¸å˜ã€‚è¿™æ ·åšçš„ç›®çš„ï¼Œæ˜¯é€æ­¥å‡å°‘å…¨å±€æ€§æ–¹æ³•ï¼Œä½¿å¾—è¯­è¨€é€æ­¥æ¨¡å—åŒ–ã€‚

```js
// ES5çš„å†™æ³•
parseFloat('123.45#') // 123.45

// ES6çš„å†™æ³•
Number.parseFloat('123.45#') // 123.45
```

##### Number.isInteger()

ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•°å€¼æ˜¯å¦ä¸ºæ•´æ•°ã€‚

```js
Number.isInteger(25) // true
Number.isInteger(25.1) // false

Number.isInteger() // false
Number.isInteger(null) // false
Number.isInteger('15') // false
Number.isInteger(true) // false
```

##### Number.MAX_SAFE_INTEGER

```js
Number.MAX_SAFE_INTEGER === Math.pow(2, 53) - 1 // true

Number.MAX_SAFE_INTEGER === 9007199254740991 // true
```

##### Number.MIN_SAFE_INTEGER

```js
Number.MIN_SAFE_INTEGER === -Number.MAX_SAFE_INTEGER // true

Number.MIN_SAFE_INTEGER === -9007199254740991 // true
```

##### Number.isSafeInteger()

JavaScript èƒ½å¤Ÿå‡†ç¡®è¡¨ç¤ºçš„æ•´æ•°èŒƒå›´åœ¨-2^53åˆ°2^53ä¹‹é—´ï¼ˆä¸å«ä¸¤ä¸ªç«¯ç‚¹ï¼‰ï¼Œè¶…è¿‡è¿™ä¸ªèŒƒå›´ï¼Œæ— æ³•ç²¾ç¡®è¡¨ç¤ºè¿™ä¸ªå€¼ã€‚

```js
Math.pow(2, 53) // 9007199254740992

Math.pow(2, 53) === Math.pow(2, 53) + 1 // true
```

#### Mathæ‰©å±•

##### Math.trunc()

æ–¹æ³•ç”¨äºå»é™¤ä¸€ä¸ªæ•°çš„å°æ•°éƒ¨åˆ†ï¼Œè¿”å›æ•´æ•°éƒ¨åˆ†ã€‚

```js
console.log(Math.trunc(5.5))
console.log(Math.trunc(-5.5))
console.log(Math.trunc(true)) // 1
console.log(Math.trunc(false)) // 0
console.log(Math.trunc(NaN)) // NaN
console.log(Math.trunc(undefined)) // NaN
console.log(Math.trunc()) // NaN
```

##### Math.sign()

æ–¹æ³•ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•°åˆ°åº•æ˜¯æ­£æ•°ã€è´Ÿæ•°ã€è¿˜æ˜¯é›¶ã€‚å¯¹äºéæ•°å€¼ï¼Œä¼šå…ˆå°†å…¶è½¬æ¢ä¸ºæ•°å€¼ã€‚

å®ƒä¼šè¿”å›äº”ç§å€¼ã€‚

- å‚æ•°ä¸ºæ­£æ•°ï¼Œè¿”å›+1
- å‚æ•°ä¸ºè´Ÿæ•°ï¼Œè¿”å›-1
- å‚æ•°ä¸º 0ï¼Œè¿”å›0
- å‚æ•°ä¸º-0ï¼Œè¿”å›-0
- å…¶ä»–å€¼ï¼Œè¿”å›NaN

```js
console.log(Math.sign(5)) // 1
console.log(Math.sign(-5)) // -1
console.log(Math.sign(0)) // 0
console.log(Math.sign(NaN)) // NaN
console.log(Math.sign(true)) // 1
console.log(Math.sign(false)) // 0
```

##### Math.cbrt()

æ–¹æ³•ç”¨äºè®¡ç®—ä¸€ä¸ªæ•°çš„ç«‹æ–¹æ ¹ã€‚

```js
console.log(Math.cbrt(8)) // 2

console.log(Math.cbrt('LYH')) // NaN
```

### Proxyä»£ç†

åœ¨ ES6 æ ‡å‡†ä¸­æ–°å¢çš„ä¸€ä¸ªéå¸¸å¼ºå¤§çš„åŠŸèƒ½æ˜¯ Proxyï¼Œå®ƒå¯ä»¥è‡ªå®šä¹‰ä¸€äº›å¸¸ç”¨è¡Œä¸ºå¦‚æŸ¥æ‰¾ã€èµ‹å€¼ã€æšä¸¾ã€å‡½æ•°è°ƒç”¨ç­‰ã€‚é€šè¿‡ Proxy è¿™ä¸ªåç§°ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥å®ƒåŒ…å«äº†â€œä»£ç†â€çš„å«ä¹‰ï¼Œåªè¦æœ‰â€œä»£ç†â€çš„è¯‰æ±‚éƒ½å¯ä»¥è€ƒè™‘ä½¿ç”¨ Proxy æ¥å®ç°ã€‚

#### åŸºæœ¬è¯­æ³•

**è¯­æ³•**

```js
let p = new Proxy(target, handler)
```

**è§£é‡Š**

|  å‚æ•°   |                             å«ä¹‰                             | å¿…é€‰ |
| :-----: | :----------------------------------------------------------: | :--: |
| target  | ç”¨ Proxy åŒ…è£…çš„ç›®æ ‡å¯¹è±¡ï¼ˆå¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬åŸç”Ÿæ•°ç»„ï¼Œå‡½æ•°ï¼Œç”šè‡³å¦ä¸€ä¸ªä»£ç†ï¼‰ |  Y   |
| handler |    ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶å±æ€§æ˜¯å½“æ‰§è¡Œä¸€ä¸ªæ“ä½œæ—¶å®šä¹‰ä»£ç†çš„è¡Œä¸ºçš„å‡½æ•°    |  Y   |

MDN ç»™å‡ºçš„è§£é‡Šåå®˜æ–¹ï¼Œé€šä¿—çš„è®²ç¬¬ä¸€ä¸ªå‚æ•° target å°±æ˜¯ç”¨æ¥ä»£ç†çš„â€œå¯¹è±¡â€ï¼Œè¢«ä»£ç†ä¹‹åå®ƒæ˜¯ä¸èƒ½ç›´æ¥è¢«è®¿é—®çš„ï¼Œè€Œ handler å°±æ˜¯å®ç°ä»£ç†çš„è¿‡ç¨‹ã€‚

````js
// ES5
let obj = {}
let newVal = ''
Object.defineProperty(obj, 'name', {
    get(){
        return newVal
    },
    set(val){
        console.log('set')
        // this.name = val
        newVal = val
    }
})
obj.name = 'es'

// proxy
let obj = {}
let p = new Proxy(obj, {})
obj.name = 'imooc'
console.log(obj.name)
for(let key in obj){
    console.log(key)
}
````

#### æ‹¦æˆªæ“ä½œåœºæ™¯

**åœºæ™¯**

æˆ‘ä»¬ç»å¸¸è¯»å–ä¸€ä¸ªå¯¹è±¡çš„ key-valueï¼š

```js
let o = {
    name: 'XHT',
    age: 18
}

console.log(o.name) // XHT
console.log(o.age) // 18
console.log(o.from) // undefined
```

å½“æˆ‘ä»¬è¯»å– from çš„æ—¶å€™è¿”å›çš„æ˜¯ undefinedï¼Œå› ä¸º o è¿™ä¸ªå¯¹è±¡ä¸­æ²¡æœ‰è¿™ä¸ª key-valueã€‚æƒ³æƒ³çœ‹æˆ‘ä»¬åœ¨è¯»å–æ•°æ®çš„æ—¶å€™ï¼Œè¿™ä¸ªæ•°æ®ç»å¸¸æ˜¯èšåˆçš„ï¼Œå½“å¤§å®¶æ²¡æœ‰æŒ‰ç…§è§„èŒƒæ¥çš„æ—¶å€™æˆ–è€…æ•°æ®ç¼ºå¤±çš„æƒ…å†µä¸‹ï¼Œç»å¸¸ä¼šå‡ºç°è¿™ç§â€œä¹Œé¾™â€ç°è±¡ã€‚

å¦‚æœæˆ‘ä»¬ä¸æƒ³åœ¨è°ƒç”¨ key çš„æ—¶å€™è¿”å› undefinedï¼Œä¹‹å‰çš„åšæ³•æ˜¯è¿™æ ·çš„ï¼š

```js
console.log(o.from || '')
```

å¦‚æœæˆ‘ä»¬å¯¹æ‰€æœ‰ä»£ç éƒ½æ˜¯è¿™ç§å†™æ³•ï¼Œé‚£é˜…è¯»æ€§å’Œè§‚èµæ€§å°±ä¸å¾—è€ŒçŸ¥äº†ã€‚å€¼å¾—åº†å¹¸çš„æ˜¯ï¼ŒES6 çš„ Proxy å¯ä»¥è®©æˆ‘ä»¬è½»æ¾çš„è§£å†³è¿™ä¸€é—®é¢˜ï¼š

```js
let o = {
    name: 'jiaojiao',
    age: 20
}

let handler = {
    get(obj, key) {
        return Reflect.has(obj, key) ? obj[key] : ''
    }
}

let p = new Proxy(o, handler)

console.log(p.from)
```

è¿™ä¸ªä»£ç æ˜¯æƒ³è¡¨è¾¾å¦‚æœ o å¯¹è±¡æœ‰è¿™ä¸ª key-value åˆ™ç›´æ¥è¿”å›ï¼Œå¦‚æœæ²¡æœ‰ä¸€å¾‹è¿”å› `''` ï¼Œå½“ç„¶è¿™é‡Œæ˜¯è‡ªå®šä¹‰ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦æ¥å†™é€‚åˆè‡ªå·±ä¸šåŠ¡çš„è§„åˆ™ã€‚

åˆšæ‰å¯¹æ•°æ®çš„â€œè¯»æ“ä½œâ€è¿›è¡Œäº†æ‹¦æˆªï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æè¿°ä¸‹â€œå†™æ“ä½œâ€è¿›è¡Œæ‹¦æˆªã€‚

**åœºæ™¯ 1**

ä»æœåŠ¡ç«¯è·å–çš„æ•°æ®å¸Œæœ›æ˜¯åªè¯»ï¼Œä¸å…è®¸åœ¨ä»»ä½•ä¸€ä¸ªç¯èŠ‚è¢«ä¿®æ”¹ã€‚

```js
// response.data æ˜¯ JSON æ ¼å¼çš„æ•°æ®ï¼Œæ¥è‡ªæœåŠ¡ç«¯çš„å“åº”
// åœ¨ ES5 ä¸­åªèƒ½é€šè¿‡éå†æŠŠæ‰€æœ‰çš„å±æ€§è®¾ç½®ä¸ºåªè¯»
for (let [key] of Object.entries(response.data)) {
    Object.defineProperty(response.data, key, {
        writable: false
    })
}
```

å¦‚æœæˆ‘ä»¬ä½¿ç”¨ Proxy å°±ç®€å•å¾ˆå¤šäº†ï¼š

```js
let data = new Proxy(response.data, {
    set(obj, key, value) {
        return false
    }
})
```

**åœºæ™¯ 2**

å¯¹äºæ•°æ®äº¤äº’è€Œè¨€ï¼Œæ ¡éªŒæ˜¯ä¸å¯æˆ–ç¼ºçš„ä¸€ä¸ªç¯å¢ƒï¼Œä¼ ç»Ÿçš„åšæ³•æ˜¯å°†æ ¡éªŒå†™åœ¨äº†ä¸šåŠ¡é€»è¾‘é‡Œï¼Œå¯¼è‡´ä»£ç è€¦åˆåº¦è¾ƒé«˜ã€‚å¦‚æœå¤§å®¶ä½¿ç”¨ Proxy å°±å¯ä»¥å°†ä»£ç è®¾è®¡çš„éå¸¸çµæ´»ã€‚

```js
// Validator.js
export default (obj, key, value) => {
    if (Reflect.has(key) && value > 20) {
        obj[key] = value
    }
}

import Validator from './Validator'
let data = new Proxy(response.data, {
    set: Validator
})
```

**åœºæ™¯ 3**

å¦‚æœå¯¹è¯»å†™è¿›è¡Œç›‘æ§ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š

```js
let validator = {
    set(target, key, value) {
        if (key === 'age') {
            if (typeof value !== 'number' || Number.isNaN(value)) {
                throw new TypeError('Age must be a number')
            }
            if (value <= 0) {
                throw new TypeError('Age must be a positive number')
            }
        }
        return true
    }
}
const person = {
    age: 27
}
const proxy = new Proxy(person, validator)
proxy.age = 'foo'
// <- TypeError: Age must be a number
proxy.age = NaN
// <- TypeError: Age must be a number
proxy.age = 0
// <- TypeError: Age must be a positive number
proxy.age = 28
console.log(person.age)
// <- 28

// æ·»åŠ ç›‘æ§
window.addEventListener(
    'error',
    e => {
        console.log(e.message) // Uncaught TypeError: Age must be a number
    },
    true
)
```

**åœºæ™¯ 4**

ä»€ä¹ˆå®ä¾‹ä¸€ä¸ªå¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ id è€Œä¸”åªè¯»ã€‚

```js
class Component {
    constructor() {
        this.proxy = new Proxy({
            id: Math.random().toString(36).slice(-8)
        })
    }
    get id() {
        return this.proxy.id
    }
}
```

#### å¸¸ç”¨æ‹¦æˆªæ“ä½œ

##### get

æ‹¦æˆªå¯¹è±¡å±æ€§çš„è¯»å–ï¼Œæ¯”å¦‚proxy.fooå’Œproxy['foo']ã€‚

```js
//æ•°ç»„æ¡ˆä¾‹
let arr = [7, 8, 9]
arr = new Proxy(arr, {
    get(target, prop) {
        // console.log(target, prop)
        return prop in target ? target[prop] : 'error'
    }
})
console.log(arr[1])
console.log(arr[10])

//å¯¹è±¡æ¡ˆä¾‹
let dict = {
    'hello': 'ä½ å¥½',
    'world': 'ä¸–ç•Œ'
}
dict = new Proxy(dict, {
    get(target, prop) {
        return prop in target ? target[prop] : prop
    }
})
console.log(dict['world'])
console.log(dict['imooc'])
```

##### set

æ‹¦æˆªå¯¹è±¡å±æ€§çš„è®¾ç½®ï¼Œæ¯”å¦‚proxy.foo = væˆ–proxy['foo'] = vï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚

```js
let arr = []
arr = new Proxy(arr, {
    set(target, prop, val) {
        if (typeof val === 'number') {
            target[prop] = val
            return true
        } else {
            return false
        }
    }
})
arr.push(5)
arr.push(6)
console.log(arr[0], arr[1], arr.length)
```

##### has

æ‹¦æˆªpropKey in proxyçš„æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚

```js
let range = {
    start: 1,
    end: 5
}

range = new Proxy(range, {
    has(target, prop) {
        return prop >= target.start && prop <= target.end
    }
})
console.log(2 in range)
console.log(9 in range)
```

##### ownKeys

æ‹¦æˆªObject.getOwnPropertyNames(proxy)ã€Object.getOwnPropertySymbols(proxy)ã€Object.keys(proxy)ã€for...inå¾ªç¯ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ã€‚è¯¥æ–¹æ³•è¿”å›ç›®æ ‡å¯¹è±¡æ‰€æœ‰è‡ªèº«çš„å±æ€§çš„å±æ€§åï¼Œè€ŒObject.keys()çš„è¿”å›ç»“æœä»…åŒ…æ‹¬ç›®æ ‡å¯¹è±¡è‡ªèº«çš„å¯éå†å±æ€§ã€‚

```js
let obj = {
    name: 'imooc',
    [Symbol('es')]: 'es6'
}
console.log(Object.getOwnPropertyNames(obj))
console.log(Object.getOwnPropertySymbols(obj))
console.log(Object.keys(obj))

for (let key in obj) {
    console.log(key)
}
```

```js
let userinfo = {
    username: 'LeiYan',
    age: 20,
    _password: '***'
}
userinfo = new Proxy(userinfo, {
    ownKeys(target) {
        return Object.keys(target).filter(key => !key.startsWith('_'))
    }
})

// for (let key in userinfo) {
//     console.log(key)
// }
console.log(Object.keys(userinfo))
```

##### deleteProperty

æ‹¦æˆªdelete proxy[propKey]çš„æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚

```js
let user = {
    name: 'xiecheng',
    age: 34,
    _password: '***'
}
user = new Proxy(user, {
    get(target, prop) {
        if (prop.startsWith('_')) {
            throw new Error('ä¸å¯è®¿é—®')
        } else {
            return target[prop]
        }
    },
    set(target, prop, val) {
        if (prop.startsWith('_')) {
            throw new Error('ä¸å¯æ›´æ”¹')
        } else {
            target[prop] = val
            return true
        }
    },
    deleteProperty(target, prop) { // æ‹¦æˆªåˆ é™¤
        if (prop.startsWith('_')) {
            throw new Error('ä¸å¯åˆ é™¤')
        } else {
            delete target[prop]
            return true
        }
    },
    ownKeys(target) {
        return Object.keys(target).filter(key => !key.startsWith('_'))
    }
})
console.log(user.age)
console.log(user._password)
user.age = 18
console.log(user.age)
try {
    user._password = 'xxx'
} catch (e) {
    console.log(e.message)
}

try {
    // delete user.age
    delete user._password
} catch (e) {
    console.log(e.message)
}
console.log(user.age)

for (let key in user) {
    console.log(key)
}
```

##### apply

æ‹¦æˆª Proxy å®ä¾‹ä½œä¸ºå‡½æ•°è°ƒç”¨çš„æ“ä½œï¼Œæ¯”å¦‚proxy(...args)ã€proxy.call(object, ...args)ã€proxy.apply(...)ã€‚

```js
let sum = (...args) => {
    let num = 0
    args.forEach(item => {
        num += item
    })
    return num
}

sum = new Proxy(sum, {
    apply(target, ctx, args) {
        return target(...args) * 2
    }
})
console.log(sum(1, 2))
console.log(sum.call(null, 1, 2, 3))
console.log(sum.apply(null, [1, 2, 3]))
```

##### construct

æ‹¦æˆª Proxy å®ä¾‹ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨çš„æ“ä½œï¼Œæ¯”å¦‚new proxy(...args)ã€‚

```js
let User = class {
    constructor(name) {
        this.name = name
    }
}
User = new Proxy(User, {
    construct(target, args, newTarget) {
        console.log('construct')
        return new target(...args)
    }
})
console.log(new User('imooc'))
```

### Reflect åå°„

Reflectå¯¹è±¡ä¸Proxyå¯¹è±¡ä¸€æ ·ï¼Œä¹Ÿæ˜¯ ES6 ä¸ºäº†æ“ä½œå¯¹è±¡è€Œæä¾›çš„æ–° APIã€‚

#### è®¾è®¡ç›®çš„

- å°†Objectå±äºè¯­è¨€å†…éƒ¨çš„æ–¹æ³•æ”¾åˆ°Reflectä¸Š

```js
let obj = {}
let newVal = ''
Reflect.defineProperty(obj, 'name', {
    get() {
        return newVal
    },
    set(val) {
        console.log('set')
        // this.name = val
        newVal = val
    }
})
obj.name = 'es'
console.log(obj.name)
```

- ä¿®æ”¹æŸäº›Objectæ–¹æ³•çš„è¿”å›ç»“æœï¼Œè®©å…¶å˜å¾—æ›´åˆç†

```js
// è€å†™æ³•
try {
    Object.defineProperty(target, property, attributes)
    // success
} catch (e) {
    // failure
}

// æ–°å†™æ³•
if (Reflect.defineProperty(target, property, attributes)) {
    // success
} else {
    // failure
}
```

- è®©Objectæ“ä½œå˜æˆå‡½æ•°è¡Œä¸º

```js
// è€å†™æ³•
'assign' in Object // true

// æ–°å†™æ³•
Reflect.has(Object, 'assign') // true
```

- Reflectå¯¹è±¡çš„æ–¹æ³•ä¸Proxyå¯¹è±¡çš„æ–¹æ³•ä¸€ä¸€å¯¹åº”ï¼Œåªè¦æ˜¯Proxyå¯¹è±¡çš„æ–¹æ³•ï¼Œå°±èƒ½åœ¨Reflectå¯¹è±¡ä¸Šæ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ã€‚

```js
Proxy(target, {
    set: function(target, name, value, receiver) {
        var success = Reflect.set(target, name, value, receiver)
        if (success) {
            console.log('property ' + name + ' on ' + target + ' set to ' + value)
        }
        return success
    }
})
```

Reflect æ˜¯ä¸€ä¸ªå†…ç½®çš„å¯¹è±¡ï¼Œå®ƒæä¾›æ‹¦æˆª JavaScript æ“ä½œçš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ä¸å¤„ç†å™¨å¯¹è±¡çš„æ–¹æ³•ç›¸åŒã€‚Reflectä¸æ˜¯ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œå› æ­¤å®ƒæ˜¯ä¸å¯æ„é€ çš„ã€‚

> TIP
>
> ä¸å¤§å¤šæ•°å…¨å±€å¯¹è±¡ä¸åŒï¼ŒReflectæ²¡æœ‰æ„é€ å‡½æ•°ã€‚ä½ ä¸èƒ½å°†å…¶ä¸ä¸€ä¸ªnewè¿ç®—ç¬¦ä¸€èµ·ä½¿ç”¨ï¼Œæˆ–è€…å°†Reflectå¯¹è±¡ä½œä¸ºä¸€ä¸ªå‡½æ•°æ¥è°ƒç”¨ã€‚Reflectçš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•éƒ½æ˜¯é™æ€çš„ï¼ˆå°±åƒMathå¯¹è±¡ï¼‰

#### å¸¸ç”¨æ–¹æ³•

##### Reflect.apply()

**è¯­æ³•**

> Reflect.apply(target, thisArgument, argumentsList)

<table><thead><tr><th style="text-align: center;">å‚æ•°</th> <th style="text-align: center;">å«ä¹‰</th> <th style="text-align: center;">å¿…é€‰</th></tr></thead> <tbody><tr><td style="text-align: center;">target</td> <td style="text-align: center;">ç›®æ ‡å‡½æ•°</td> <td style="text-align: center;">Y</td></tr> <tr><td style="text-align: center;">thisArgument</td> <td style="text-align: center;">targetå‡½æ•°è°ƒç”¨æ—¶ç»‘å®šçš„thiså¯¹è±¡</td> <td style="text-align: center;">N</td></tr> <tr><td style="text-align: center;">argumentsList</td> <td style="text-align: center;">targetå‡½æ•°è°ƒç”¨æ—¶ä¼ å…¥çš„å®å‚åˆ—è¡¨ï¼Œè¯¥å‚æ•°åº”è¯¥æ˜¯ä¸€ä¸ªç±»æ•°ç»„çš„å¯¹è±¡</td> <td style="text-align: center;">N</td></tr></tbody></table>

**ç¤ºä¾‹**

```js
Reflect.apply(Math.floor, undefined, [1.75])
// 1

Reflect.apply(String.fromCharCode, undefined, [104, 101, 108, 108, 111])
// "hello"

Reflect.apply(RegExp.prototype.exec, /ab/, ['confabulation']).index
// 4

Reflect.apply(''.charAt, 'ponies', [3])
// "i"
```

**ES5 å¯¹æ¯”**

è¯¥æ–¹æ³•ä¸ES5ä¸­Function.prototype.apply()æ–¹æ³•ç±»ä¼¼ï¼šè°ƒç”¨ä¸€ä¸ªæ–¹æ³•å¹¶ä¸”æ˜¾å¼åœ°æŒ‡å®šthiså˜é‡å’Œå‚æ•°åˆ—è¡¨(arguments) ï¼Œå‚æ•°åˆ—è¡¨å¯ä»¥æ˜¯æ•°ç»„ï¼Œæˆ–ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚

```js
Function.prototype.apply.call(Math.floor, undefined, [1.75])
```

##### Reflect.construct()

Reflect.construct() æ–¹æ³•çš„è¡Œä¸ºæœ‰ç‚¹åƒ new æ“ä½œç¬¦ æ„é€ å‡½æ•° ï¼Œ ç›¸å½“äºè¿è¡Œ new target(...args).

**è¯­æ³•**

> Reflect.construct(target, argumentsList[, newTarget])

**è§£é‡Š**

<table><thead><tr><th style="text-align: center;">å‚æ•°</th> <th style="text-align: center;">å«ä¹‰</th> <th style="text-align: center;">å¿…é€‰</th></tr></thead> <tbody><tr><td style="text-align: center;">target</td> <td style="text-align: center;">è¢«è¿è¡Œçš„ç›®æ ‡å‡½æ•°</td> <td style="text-align: center;">Y</td></tr> <tr><td style="text-align: center;">argumentsList</td> <td style="text-align: center;">è°ƒç”¨æ„é€ å‡½æ•°çš„æ•°ç»„æˆ–è€…ä¼ªæ•°ç»„</td> <td style="text-align: center;">Y</td></tr> <tr><td style="text-align: center;">newTarget</td> <td style="text-align: center;">è¯¥å‚æ•°ä¸ºæ„é€ å‡½æ•°ï¼Œ å‚è€ƒ new.target æ“ä½œç¬¦ï¼Œå¦‚æœæ²¡æœ‰newTargetå‚æ•°ï¼Œ é»˜è®¤å’Œtargetä¸€æ ·</td> <td style="text-align: center;">N</td></tr></tbody></table>

| newTarget | è¯¥å‚æ•°ä¸ºæ„é€ å‡½æ•°ï¼Œ å‚è€ƒ new.target æ“ä½œç¬¦ï¼Œå¦‚æœæ²¡æœ‰newTargetå‚æ•°ï¼Œ é»˜è®¤å’Œtargetä¸€æ · | N    |
| --------- | ------------------------------------------------------------ | ---- |
|           |                                                              |      |

> [! WARNING] å¦‚æœtargetæˆ–è€…newTargetä¸æ˜¯æ„é€ å‡½æ•°ï¼ŒæŠ›å‡ºTypeError

Reflect.constructå…è®¸ä½ ä½¿ç”¨å¯å˜çš„å‚æ•°æ¥è°ƒç”¨æ„é€ å‡½æ•°

```js
var obj = new Foo(...args)
var obj = Reflect.construct(Foo, args)
```

**ç¤ºä¾‹**

```js
var d = Reflect.construct(Date, [1776, 6, 4])
d instanceof Date // true
d.getFullYear() // 1776
```

å¦‚æœä½¿ç”¨ newTarget å‚æ•°ï¼Œåˆ™è¡¨ç¤ºç»§æ‰¿äº† newTarget è¿™ä¸ªè¶…ç±»ï¼š

```js
function someConstructor() {}
var result = Reflect.construct(Array, [], someConstructor)

Reflect.getPrototypeOf(result) // è¾“å‡ºï¼šsomeConstructor.prototype
Array.isArray(result) // true
```

##### Reflect.defineProperty()

é™æ€æ–¹æ³• Reflect.defineProperty() åŸºæœ¬ç­‰åŒäº Object.defineProperty() æ–¹æ³•ï¼Œå”¯ä¸€ä¸åŒæ˜¯è¿”å› Boolean å€¼ã€‚

**è¯­æ³•**

> Reflect.defineProperty(target, propertyKey, attributes)

**è§£é‡Š**

<table><thead><tr><th style="text-align: center;">å‚æ•°</th> <th style="text-align: center;">å«ä¹‰</th> <th style="text-align: center;">å¿…é€‰</th></tr></thead> <tbody><tr><td style="text-align: center;">target</td> <td style="text-align: center;">ç›®æ ‡å¯¹è±¡</td> <td style="text-align: center;">Y</td></tr> <tr><td style="text-align: center;">propertyKey</td> <td style="text-align: center;">è¦å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§çš„åç§°</td> <td style="text-align: center;">Y</td></tr> <tr><td style="text-align: center;">attributes</td> <td style="text-align: center;">è¦å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§çš„æè¿°</td> <td style="text-align: center;">Y</td></tr></tbody></table>

**ç¤ºä¾‹**

```js
const student = {}
Reflect.defineProperty(student, 'name', {
    value: 'Mike'
}) // true
student.name // "Mike"
```

##### Reflect.deleteProperty()

Reflect.deleteProperty å…è®¸ä½ åˆ é™¤ä¸€ä¸ªå¯¹è±¡ä¸Šçš„å±æ€§ã€‚è¿”å›ä¸€ä¸ª Boolean å€¼è¡¨ç¤ºè¯¥å±æ€§æ˜¯å¦è¢«æˆåŠŸåˆ é™¤ã€‚å®ƒå‡ ä¹ä¸éä¸¥æ ¼çš„ delete operator ç›¸åŒã€‚

**è¯­æ³•**

> Reflect.deleteProperty(target, propertyKey)

**è§£é‡Š**

<table><thead><tr><th style="text-align: center;">å‚æ•°</th> <th style="text-align: center;">å«ä¹‰</th> <th style="text-align: center;">å¿…é€‰</th></tr></thead> <tbody><tr><td style="text-align: center;">target</td> <td style="text-align: center;">åˆ é™¤å±æ€§çš„ç›®æ ‡å¯¹è±¡</td> <td style="text-align: center;">Y</td></tr> <tr><td style="text-align: center;">propertyKey</td> <td style="text-align: center;">å°†è¢«åˆ é™¤çš„å±æ€§çš„åç§°</td> <td style="text-align: center;">Y</td></tr></tbody></table>

**ç¤ºä¾‹**

```js
var obj = {
    x: 1,
    y: 2
}
Reflect.deleteProperty(obj, "x") // true
obj // { y: 2 }

var arr = [1, 2, 3, 4, 5]
Reflect.deleteProperty(arr, "3") // true
arr // [1, 2, 3, , 5]

// å¦‚æœå±æ€§ä¸å­˜åœ¨ï¼Œè¿”å› true
Reflect.deleteProperty({}, "foo") // true

// å¦‚æœå±æ€§ä¸å¯é…ç½®ï¼Œè¿”å› false
Reflect.deleteProperty(Object.freeze({
    foo: 1
}), "foo") // false
```

##### Reflect.get()

Reflect.get() æ–¹æ³•çš„å·¥ä½œæ–¹å¼ï¼Œå°±åƒä» object (target[propertyKey]) ä¸­è·å–å±æ€§ï¼Œä½†å®ƒæ˜¯ä½œä¸ºä¸€ä¸ªå‡½æ•°æ‰§è¡Œçš„ã€‚

**è¯­æ³•**

> Reflect.get(target, propertyKey[, receiver])

**è§£é‡Š**

<table><thead><tr><th style="text-align: center;">å‚æ•°</th> <th style="text-align: center;">å«ä¹‰</th> <th style="text-align: center;">å¿…é€‰</th></tr></thead> <tbody><tr><td style="text-align: center;">target</td> <td style="text-align: center;">éœ€è¦å–å€¼çš„ç›®æ ‡å¯¹è±¡</td> <td style="text-align: center;">Y</td></tr> <tr><td style="text-align: center;">propertyKey</td> <td style="text-align: center;">éœ€è¦è·å–çš„å€¼çš„é”®å€¼</td> <td style="text-align: center;">Y</td></tr> <tr><td style="text-align: center;">receiver</td> <td style="text-align: center;">å¦‚æœé‡åˆ° getterï¼Œæ­¤å€¼å°†æä¾›ç»™ç›®æ ‡è°ƒç”¨</td> <td style="text-align: center;">N</td></tr></tbody></table>

**ç¤ºä¾‹**

```js
// Object
var obj = {
    x: 1,
    y: 2
}
Reflect.get(obj, 'x') // 1

// Array
Reflect.get(['zero', 'one'], 1) // "one"

// Proxy with a get handler
var x = {
    p: 1
}
var obj = new Proxy(x, {
    get(t, k, r) {
        return k + 'bar'
    }
})
Reflect.get(obj, 'foo') // "foobar"
```

##### Reflect.getOwnPropertyDescriptor()

é™æ€æ–¹æ³• Reflect.getOwnPropertyDescriptor() ä¸ Object.getOwnPropertyDescriptor() æ–¹æ³•ç›¸ä¼¼ã€‚å¦‚æœåœ¨å¯¹è±¡ä¸­å­˜åœ¨ï¼Œåˆ™è¿”å›ç»™å®šçš„å±æ€§çš„å±æ€§æè¿°ç¬¦ï¼Œå¦åˆ™è¿”å› undefinedã€‚

**è¯­æ³•**

> Reflect.getOwnPropertyDescriptor(target, propertyKey)

**è§£é‡Š**

<table><thead><tr><th style="text-align: center;">å‚æ•°</th> <th style="text-align: center;">å«ä¹‰</th> <th style="text-align: center;">å¿…é€‰</th></tr></thead> <tbody><tr><td style="text-align: center;">target</td> <td style="text-align: center;">éœ€è¦å¯»æ‰¾å±æ€§çš„ç›®æ ‡å¯¹è±¡</td> <td style="text-align: center;">Y</td></tr> <tr><td style="text-align: center;">propertyKey</td> <td style="text-align: center;">è·å–è‡ªå·±çš„å±æ€§æè¿°ç¬¦çš„å±æ€§çš„åç§°</td> <td style="text-align: center;">N</td></tr></tbody></table>

**ç¤ºä¾‹**

```js
Reflect.getOwnPropertyDescriptor({
    x: 'hello'
}, 'x')
// {value: "hello", writable: true, enumerable: true, configurable: true}

Reflect.getOwnPropertyDescriptor({
    x: 'hello'
}, 'y')
// undefined

Reflect.getOwnPropertyDescriptor([], 'length')
// {value: 0, writable: true, enumerable: false, configurable: false}
```

**å¯¹æ¯”**

å¦‚æœè¯¥æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆä¸€ä¸ªåŸå§‹å€¼ï¼‰ï¼Œé‚£ä¹ˆå°†é€ æˆ TypeError é”™è¯¯ã€‚è€Œå¯¹äº Object.getOwnPropertyDescriptorï¼Œéå¯¹è±¡çš„ç¬¬ä¸€ä¸ªå‚æ•°å°†è¢«å¼ºåˆ¶è½¬æ¢ä¸ºä¸€ä¸ªå¯¹è±¡å¤„ç†ã€‚

```js
Reflect.getOwnPropertyDescriptor("foo", 0)
// TypeError: "foo" is not non-null object

Object.getOwnPropertyDescriptor("foo", 0)
// { value: "f", writable: false, enumerable: true, configurable: false }
```

##### Reflect.getPrototypeOf()

é™æ€æ–¹æ³• Reflect.getPrototypeOf() ä¸ Object.getPrototypeOf() æ–¹æ³•æ˜¯ä¸€æ ·çš„ã€‚éƒ½æ˜¯è¿”å›æŒ‡å®šå¯¹è±¡çš„åŸå‹ï¼ˆå³ï¼Œå†…éƒ¨çš„ [[Prototype]] å±æ€§çš„å€¼ï¼‰ã€‚

**è¯­æ³•**

> Reflect.getPrototypeOf(target)

**è§£é‡Š**

<table><thead><tr><th style="text-align: center;">å‚æ•°</th> <th style="text-align: center;">å«ä¹‰</th> <th style="text-align: center;">å¿…é€‰</th></tr></thead> <tbody><tr><td style="text-align: center;">target</td> <td style="text-align: center;">è·å–åŸå‹çš„ç›®æ ‡å¯¹è±¡</td> <td style="text-align: center;">Y</td></tr></tbody></table>

##### Reflect.has()

Reflect.has ç”¨äºæ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ‹¥æœ‰æŸä¸ªå±æ€§ï¼Œ ç›¸å½“äºin æ“ä½œç¬¦

**è¯­æ³•**

> Reflect.has(target, propertyKey)

**è§£é‡Š**

<table><thead><tr><th style="text-align: center;">å‚æ•°</th> <th style="text-align: center;">å«ä¹‰</th> <th style="text-align: center;">å¿…é€‰</th></tr></thead> <tbody><tr><td style="text-align: center;">target</td> <td style="text-align: center;">è·å–åŸå‹çš„ç›®æ ‡å¯¹è±¡</td> <td style="text-align: center;">Y</td></tr> <tr><td style="text-align: center;">propertyKey</td> <td style="text-align: center;">å±æ€§åï¼Œéœ€è¦æ£€æŸ¥ç›®æ ‡å¯¹è±¡æ˜¯å¦å­˜åœ¨æ­¤å±æ€§</td> <td style="text-align: center;">Y</td></tr></tbody></table>

##### Reflect.isExtensible()

Reflect.isExtensible åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯æ‰©å±• ï¼ˆå³æ˜¯å¦èƒ½å¤Ÿæ·»åŠ æ–°çš„å±æ€§ï¼‰ï¼Œå®ƒä¸ Object.isExtensible() æ–¹æ³•ä¸€æ ·ã€‚

**è¯­æ³•**

> Reflect.isExtensible(target)

**è§£é‡Š**

<table><thead><tr><th style="text-align: center;">å‚æ•°</th> <th style="text-align: center;">å«ä¹‰</th> <th style="text-align: center;">å¿…é€‰</th></tr></thead> <tbody><tr><td style="text-align: center;">target</td> <td style="text-align: center;">è·å–åŸå‹çš„ç›®æ ‡å¯¹è±¡</td> <td style="text-align: center;">Y</td></tr></tbody></table>

#####  Reflect.ownKeys()

Reflect.ownKeys æ–¹æ³•è¿”å›ä¸€ä¸ªç”±ç›®æ ‡å¯¹è±¡è‡ªèº«çš„å±æ€§é”®ç»„æˆçš„æ•°ç»„ã€‚å®ƒçš„è¿”å›å€¼ç­‰åŒäº Object.getOwnPropertyNames(target).concat(Object.getOwnPropertySymbols(target))

**è¯­æ³•**

> Reflect.ownKeys(target)

**è§£é‡Š**

<table><thead><tr><th style="text-align: center;">å‚æ•°</th> <th style="text-align: center;">å«ä¹‰</th> <th style="text-align: center;">å¿…é€‰</th></tr></thead> <tbody><tr><td style="text-align: center;">target</td> <td style="text-align: center;">è·å–åŸå‹çš„ç›®æ ‡å¯¹è±¡</td> <td style="text-align: center;">Y</td></tr></tbody></table>

**ç¤ºä¾‹**

```js
Reflect.ownKeys({
    z: 3,
    y: 2,
    x: 1
}) // [ "z", "y", "x" ]
Reflect.ownKeys([]) // ["length"]

var sym = Symbol.for("comet")
var sym2 = Symbol.for("meteor")
var obj = {
    [sym]: 0,
    "str": 0,
    "773": 0,
    "0": 0,
    [sym2]: 0,
    "-1": 0,
    "8": 0,
    "second str": 0
}
Reflect.ownKeys(obj)
// [ "0", "8", "773", "str", "-1", "second str", Symbol(comet), Symbol(meteor) ]
// Indexes in numeric order,
// strings in insertion order,
// symbols in insertion order
```

##### Reflect.preventExtensions()

Reflect.preventExtensions æ–¹æ³•é˜»æ­¢æ–°å±æ€§æ·»åŠ åˆ°å¯¹è±¡ ä¾‹å¦‚ï¼šé˜²æ­¢å°†æ¥å¯¹å¯¹è±¡çš„æ‰©å±•è¢«æ·»åŠ åˆ°å¯¹è±¡ä¸­)ã€‚è¯¥æ–¹æ³•ä¸ Object.preventExtensions() æ–¹æ³•ä¸€è‡´

**è¯­æ³•**

> Reflect.preventExtensions(target)

**è§£é‡Š**

<table><thead><tr><th style="text-align: center;">å‚æ•°</th> <th style="text-align: center;">å«ä¹‰</th> <th style="text-align: center;">å¿…é€‰</th></tr></thead> <tbody><tr><td style="text-align: center;">target</td> <td style="text-align: center;">è·å–åŸå‹çš„ç›®æ ‡å¯¹è±¡</td> <td style="text-align: center;">Y</td></tr></tbody></table>

**ç¤ºä¾‹**

```js
// Objects are extensible by default.
var empty = {}
Reflect.isExtensible(empty) // === true

// ...but that can be changed.
Reflect.preventExtensions(empty)
Reflect.isExtensible(empty) // === false
Reflect.preventExtensions(1)
// TypeError: 1 is not an object

Object.preventExtensions(1)
// 1
```

##### Reflect.set()

Reflect.set æ–¹æ³•å…è®¸ä½ åœ¨å¯¹è±¡ä¸Šè®¾ç½®å±æ€§ã€‚å®ƒçš„ä½œç”¨æ˜¯ç»™å±æ€§èµ‹å€¼å¹¶ä¸”å°±åƒ property accessor è¯­æ³•ä¸€æ ·ï¼Œä½†æ˜¯å®ƒæ˜¯ä»¥å‡½æ•°çš„æ–¹å¼ã€‚

**è¯­æ³•**

> Reflect.set(target, propertyKey, value[, receiver])

**è§£é‡Š**

<table><thead><tr><th style="text-align: center;">å‚æ•°</th> <th style="text-align: center;">å«ä¹‰</th> <th style="text-align: center;">å¿…é€‰</th></tr></thead> <tbody><tr><td style="text-align: center;">target</td> <td style="text-align: center;">è·å–åŸå‹çš„ç›®æ ‡å¯¹è±¡</td> <td style="text-align: center;">Y</td></tr> <tr><td style="text-align: center;">propertyKey</td> <td style="text-align: center;">è®¾ç½®çš„å±æ€§çš„åç§°</td> <td style="text-align: center;">Y</td></tr> <tr><td style="text-align: center;">value</td> <td style="text-align: center;">è®¾ç½®çš„å€¼</td> <td style="text-align: center;">Y</td></tr> <tr><td style="text-align: center;">receiver</td> <td style="text-align: center;">å¦‚æœé‡åˆ° setterï¼Œthis å°†æä¾›ç»™ç›®æ ‡è°ƒç”¨</td> <td style="text-align: center;">N</td></tr></tbody></table>

**ç¤ºä¾‹**

```js
// Object
var obj = {}
Reflect.set(obj, "prop", "value") // true
obj.prop // "value"

// Array
var arr = ["duck", "duck", "duck"]
Reflect.set(arr, 2, "goose") // true
arr[2] // "goose"

// It can truncate an array.
Reflect.set(arr, "length", 1) // true
arr // ["duck"]

// With just one argument, propertyKey and value are "undefined".
var obj = {}
Reflect.set(obj) // true
Reflect.getOwnPropertyDescriptor(obj, "undefined")
// { value: undefined, writable: true, enumerable: true, configurable: true }
```

##### Reflect.setPrototypeOf()

Reflect.setPrototypeOf æ–¹æ³•æ”¹å˜æŒ‡å®šå¯¹è±¡çš„åŸå‹ ï¼ˆå³ï¼Œå†…éƒ¨çš„ [[Prototype]] å±æ€§å€¼ï¼‰

**è¯­æ³•**

> Reflect.setPrototypeOf(target, prototype)

**è§£é‡Š**

|   å‚æ•°    |               å«ä¹‰               | å¿…é€‰ |
| :-------: | :------------------------------: | :--: |
|  target   |        è·å–åŸå‹çš„ç›®æ ‡å¯¹è±¡        |  Y   |
| prototype | å¯¹è±¡çš„æ–°åŸå‹ ï¼ˆä¸€ä¸ªå¯¹è±¡æˆ– nullï¼‰ |  Y   |

**ç¤ºä¾‹**

```js
Reflect.setPrototypeOf({}, Object.prototype) // true

// It can change an object's [[Prototype]] to null.
Reflect.setPrototypeOf({}, null) // true

// Returns false if target is not extensible.
Reflect.setPrototypeOf(Object.freeze({}), null) // false

// Returns false if it cause a prototype chain cycle.
var target = {}
var proto = Object.create(target)
Reflect.setPrototypeOf(target, proto) // false
```

<div class="custom-block warning"><p class="custom-block-title">æ³¨æ„</p> <p>å¯¹äºä»¥ä¸Šæ‰€æœ‰ API ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ Object çš„ï¼Œå¦‚æœç»™å®šçš„ä¸æ˜¯ Object åˆ™æŠ›å‡ºä¸€ä¸ª TypeError å¼‚å¸¸</p></div>

